<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ArbPro | Advanced Crypto Arbitrage Platform</title>
    <!-- Manifest -->
    <link rel="manifest" href="manifest.json">

    <!-- iOS Support -->
    <link rel="apple-touch-icon" href="icons/icon-192x192.png">
    <meta name="apple-mobile-web-app-status-bar" content="#2563eb">

    <!-- Theme Color -->
    <meta name="theme-color" content="#2563eb">
    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
   
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Inter', 'Segoe UI', 'SF Pro Display', -apple-system, system-ui, sans-serif;
        }
        
        :root {
            --primary: #2563eb;
            --primary-light: #3b82f6;
            --primary-dark: #1d4ed8;
            --secondary: #1e293b;
            --success: #10b981;
            --success-dark: #059669;
            --warning: #f59e0b;
            --danger: #ef4444;
            --dark: #0f172a;
            --darker: #0b1120;
            --light: #f8fafc;
            --gray: #64748b;
            --card-bg: rgba(30, 41, 59, 0.85);
            --card-border: rgba(148, 163, 184, 0.25);
            --card-hover: rgba(30, 41, 59, 0.95);
            --gradient-start: #2563eb;
            --gradient-end: #8b5cf6;
        }
        
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap');
        
        body {
            background: linear-gradient(135deg, var(--darker), var(--secondary));
            background-attachment: fixed;
            color: var(--light);
            min-height: 100vh;
            padding: 20px 15px;
            line-height: 1.6;
            font-size: 16px;
            position: relative;
            overflow-x: hidden;
        }
        
        body::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at 10% 20%, rgba(59, 130, 246, 0.1) 0%, transparent 20%),
                        radial-gradient(circle at 90% 80%, rgba(139, 92, 246, 0.1) 0%, transparent 20%);
            z-index: -1;
        }
        
        .particles {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
            z-index: -1;
        }
        
        .particle {
            position: absolute;
            width: 2px;
            height: 2px;
            background: rgba(59, 130, 246, 0.5);
            border-radius: 50%;
            animation: float 15s infinite linear;
        }
        
        @keyframes float {
            0% {
                transform: translateY(0) translateX(0);
                opacity: 0;
            }
            10% {
                opacity: 1;
            }
            90% {
                opacity: 1;
            }
            100% {
                transform: translateY(-100vh) translateX(100px);
                opacity: 0;
            }
        }
        
        header {
            text-align: center;
            margin-bottom: 25px;
            padding: 20px;
            background: var(--card-bg);
            border-radius: 20px;
            border: 1px solid var(--card-border);
            backdrop-filter: blur(12px);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            position: relative;
            overflow: hidden;
        }
        
        header::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: linear-gradient(90deg, var(--gradient-start), var(--gradient-end));
        }
        
        .logo {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            margin-bottom: 15px;
        }
        
        .logo-icon {
            width: 70px;
            height: 70px;
            background: linear-gradient(135deg, var(--gradient-start), var(--gradient-end));
            border-radius: 18px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 15px rgba(37, 99, 235, 0.3);
            position: relative;
            overflow: hidden;
        }
        
        .logo-icon::before {
            content: "";
            position: absolute;
            width: 150%;
            height: 150%;
            background: linear-gradient(45deg, transparent, rgba(255, 255, 255, 0.1), transparent);
            transform: rotate(-45deg);
            animation: shine 3s infinite;
        }
        
        @keyframes shine {
            0% { left: -100%; }
            20% { left: 100%; }
            100% { left: 100%; }
        }
        
        .logo-icon i {
            font-size: 32px;
            color: white;
            z-index: 1;
        }
        
        h1 {
            font-size: 2.5rem;
            background: linear-gradient(to right, var(--gradient-start), var(--gradient-end));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            margin-bottom: 8px;
            font-weight: 800;
            letter-spacing: -0.5px;
        }
        
        .subtitle {
            color: var(--gray);
            font-size: 1.1rem;
            margin: 0 auto;
            max-width: 600px;
            line-height: 1.5;
        }
        
        .header-controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 20px;
            flex-wrap: wrap;
        }
        
        .container {
            display: flex;
            flex-direction: column;
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .card {
            background: var(--card-bg);
            border-radius: 20px;
            padding: 25px 20px;
            border: 1px solid var(--card-border);
            backdrop-filter: blur(10px);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.25);
            position: relative;
            overflow: hidden;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.35);
            background: var(--card-hover);
        }
        
        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--card-border);
        }
        
        .card-title {
            font-size: 1.5rem;
            display: flex;
            align-items: center;
            gap: 10px;
            font-weight: 600;
        }
        
        .card-title i {
            color: var(--primary);
            background: rgba(37, 99, 235, 0.15);
            width: 40px;
            height: 40px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .controls {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .control-row {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }
        
        .control-group {
            display: flex;
            flex-direction: column;
            flex: 1;
            min-width: 180px;
        }
        
        label {
            margin-bottom: 8px;
            font-weight: 600;
            color: #e2e8f0;
            font-size: 0.95rem;
            display: flex;
            align-items: center;
            gap: 6px;
        }
        
        .info-icon {
            color: var(--primary-light);
            cursor: help;
            position: relative;
        }
        
        select, input {
            padding: 12px 15px;
            border-radius: 12px;
            border: 1px solid var(--card-border);
            background: rgba(15, 23, 42, 0.6);
            color: var(--light);
            font-size: 1rem;
            width: 100%;
            transition: all 0.3s ease;
        }
        
        select:focus, input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.3);
        }
        
        .btn {
            padding: 12px 20px;
            border-radius: 12px;
            border: none;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1rem;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            width: 100%;
        }
        
        .btn-primary {
            background: linear-gradient(to right, var(--gradient-start), var(--gradient-end));
            color: white;
            box-shadow: 0 4px 15px rgba(37, 99, 235, 0.3);
        }
        
        .btn-primary:hover {
            background: linear-gradient(to right, var(--primary-dark), #7c3aed);
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(37, 99, 235, 0.4);
        }
        
        .btn-outline {
            background: transparent;
            border: 2px solid var(--primary);
            color: var(--primary);
        }
        
        .btn-outline:hover {
            background: rgba(37, 99, 235, 0.1);
            transform: translateY(-3px);
        }
        
        .btn-success {
            background: var(--success);
            color: white;
            box-shadow: 0 4px 15px rgba(16, 185, 129, 0.3);
        }
        
        .btn-success:hover {
            background: var(--success-dark);
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(16, 185, 129, 0.4);
        }
        
        .btn-warning {
            background: rgba(239, 68, 68, 0.1);
            border: 2px solid rgba(239, 68, 68, 0.3);
            color: #ef4444;
        }
        
        .btn-warning:hover {
            background: rgba(239, 68, 68, 0.2);
            transform: translateY(-3px);
        }
        
        .btn-group {
            display: flex;
            flex-direction: column;
            gap: 12px;
            margin-top: 15px;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            font-size: 0.95rem;
        }
        
        th {
            background: rgba(15, 23, 42, 0.7);
            padding: 14px 12px;
            text-align: left;
            color: #94a3b8;
            font-weight: 600;
            font-size: 0.9rem;
            position: sticky;
            top: 0;
        }
        
        td {
            padding: 14px 12px;
            border-bottom: 1px solid var(--card-border);
            font-size: 0.95rem;
        }
        
        tr:last-child td {
            border-bottom: none;
        }
        
        tr:hover {
            background: rgba(15, 23, 42, 0.4);
        }
        
        .profit {
            color: var(--success);
            font-weight: 700;
        }
        
        .loss {
            color: var(--danger);
            font-weight: 700;
        }
        
        .exchange-logo {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            margin-right: 10px;
            object-fit: cover;
        }
        
        .opportunity-card {
            background: rgba(15, 23, 42, 0.6);
            border-radius: 16px;
            padding: 20px;
            margin-top: 20px;
            border: 1px solid rgba(59, 130, 246, 0.3);
            background: linear-gradient(to right, rgba(15, 23, 42, 0.7), rgba(30, 41, 59, 0.8));
            position: relative;
            overflow: hidden;
        }
        
        .opportunity-card::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 4px;
            height: 100%;
            background: linear-gradient(to bottom, var(--gradient-start), var(--gradient-end));
        }
        
        .opportunity-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .opportunity-badge {
            padding: 6px 14px;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 700;
        }
        
        .badge-success {
            background: rgba(16, 185, 129, 0.2);
            color: var(--success);
        }
        
        .badge-warning {
            background: rgba(245, 158, 11, 0.2);
            color: var(--warning);
        }
        
        .opportunity-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
        }
        
        .opportunity-item {
            display: flex;
            flex-direction: column;
        }
        
        .opportunity-label {
            color: #94a3b8;
            font-size: 0.9rem;
            margin-bottom: 5px;
        }
        
        .opportunity-value {
            font-size: 1.1rem;
            font-weight: 700;
        }
        
        .chart-container {
            height: 280px;
            margin-top: 20px;
        }
        
        .notification {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: var(--success);
            color: white;
            padding: 15px 20px;
            border-radius: 12px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
            display: flex;
            align-items: center;
            gap: 10px;
            z-index: 1000;
            transform: translateX(150%);
            transition: transform 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            max-width: 350px;
        }
        
        .notification.show {
            transform: translateX(0);
        }
        
        .notification.warning {
            background: var(--warning);
        }
        
        .privacy-toggle {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 12px;
            background: rgba(15, 23, 42, 0.6);
            padding: 10px 15px;
            border-radius: 50px;
            margin-top: 20px;
            font-size: 0.95rem;
        }
        
        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 48px;
            height: 24px;
        }
        
        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        
        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #334155;
            transition: .4s;
            border-radius: 24px;
        }
        
        .slider:before {
            position: absolute;
            content: "";
            height: 18px;
            width: 18px;
            left: 3px;
            bottom: 3px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }
        
        input:checked + .slider {
            background-color: var(--success);
        }
        
        input:checked + .slider:before {
            transform: translateX(24px);
        }
        
        footer {
            text-align: center;
            margin-top: 30px;
            padding: 20px;
            color: var(--gray);
            font-size: 0.9rem;
            background: var(--card-bg);
            border-radius: 16px;
            border: 1px solid var(--card-border);
        }
        
        .features {
            display: grid;
            grid-template-columns: 1fr;
            gap: 20px;
            margin-top: 30px;
        }
        
        .feature {
            background: rgba(15, 23, 42, 0.5);
            padding: 25px 20px;
            border-radius: 16px;
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            border: 1px solid var(--card-border);
            transition: transform 0.3s ease;
        }
        
        .feature:hover {
            transform: translateY(-5px);
            background: rgba(15, 23, 42, 0.6);
        }
        
        .feature i {
            font-size: 2rem;
            color: var(--primary);
            margin-bottom: 15px;
            background: rgba(37, 99, 235, 0.15);
            width: 60px;
            height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 16px;
        }
        
        .feature h3 {
            margin-bottom: 12px;
            color: #e2e8f0;
            font-size: 1.2rem;
            font-weight: 600;
        }
        
        .feature p {
            color: #94a3b8;
            font-size: 0.95rem;
            line-height: 1.6;
        }
        
        .disclaimer {
            background: rgba(239, 68, 68, 0.1);
            border: 1px solid rgba(239, 68, 68, 0.3);
            border-radius: 16px;
            padding: 20px;
            margin-top: 30px;
            font-size: 0.9rem;
        }
        
        .disclaimer h3 {
            color: var(--danger);
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            font-size: 1.1rem;
            font-weight: 600;
        }
        
        .status-indicator {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.95rem;
            margin-top: 15px;
            color: #94a3b8;
            padding: 10px 15px;
            background: rgba(15, 23, 42, 0.5);
            border-radius: 12px;
        }
        
        .status-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background-color: var(--success);
        }
        
        .status-dot.offline {
            background-color: var(--danger);
        }
        
        .refresh-indicator {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.95rem;
        }
        
        .tooltip {
            position: absolute;
            background: rgba(15, 23, 42, 0.95);
            border: 1px solid var(--primary);
            border-radius: 8px;
            padding: 12px;
            z-index: 100;
            max-width: 280px;
            font-size: 0.9rem;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
            display: none;
            backdrop-filter: blur(10px);
        }
        
        .scan-status {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px 15px;
            background: rgba(15, 23, 42, 0.6);
            border-radius: 12px;
            margin-top: 15px;
            font-size: 0.95rem;
        }
        
        .scan-status .spinner {
            width: 20px;
            height: 20px;
            border: 3px solid rgba(59, 130, 246, 0.3);
            border-top: 3px solid var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* New Innovative Features Styles */
        .path-visualization {
            margin-top: 20px;
            padding: 15px;
            background: rgba(15, 23, 42, 0.5);
            border-radius: 12px;
            border: 1px solid var(--card-border);
        }
        
        .path-node {
            display: inline-flex;
            align-items: center;
            padding: 8px 15px;
            background: rgba(37, 99, 235, 0.1);
            border-radius: 20px;
            margin: 0 10px;
            border: 1px solid rgba(37, 99, 235, 0.3);
        }
        
        .path-arrow {
            color: var(--primary);
            font-size: 1.2rem;
        }
        
        .analytics-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-top: 20px;
        }
        
        .analytics-card {
            background: rgba(15, 23, 42, 0.5);
            padding: 15px;
            border-radius: 12px;
            border: 1px solid var(--card-border);
        }
        
        .analytics-value {
            font-size: 1.5rem;
            font-weight: 700;
            margin: 5px 0;
        }
        
        .analytics-label {
            color: #94a3b8;
            font-size: 0.9rem;
        }
        
        .multi-leg-toggle {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-top: 15px;
        }
        
        .advanced-filters {
            margin-top: 20px;
            padding: 15px;
            background: rgba(15, 23, 42, 0.5);
            border-radius: 12px;
            border: 1px solid var(--card-border);
        }
        
        .filter-row {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            margin-bottom: 15px;
        }
        
        .filter-group {
            flex: 1;
            min-width: 180px;
        }
        
        .liquidity-map {
            height: 200px;
            margin-top: 20px;
            background: rgba(15, 23, 42, 0.5);
            border-radius: 12px;
            border: 1px solid var(--card-border);
            position: relative;
            overflow: hidden;
        }
        
        .liquidity-node {
            position: absolute;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background: var(--primary);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            transform: translate(-50%, -50%);
            box-shadow: 0 0 10px rgba(37, 99, 235, 0.5);
        }
        
        .liquidity-connection {
            position: absolute;
            background: rgba(37, 99, 235, 0.3);
            transform-origin: 0 0;
        }
        
        /* Tablet and larger */
        @media (min-width: 768px) {
            body {
                padding: 25px 20px;
            }
            
            .container {
                display: grid;
                grid-template-columns: 1fr 1fr;
                gap: 25px;
            }
            
            .btn-group {
                flex-direction: row;
                flex-wrap: wrap;
            }
            
            .btn {
                width: auto;
                flex: 1;
            }
            
            .features {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .header-controls {
                justify-content: flex-end;
            }
            
            .analytics-grid {
                grid-template-columns: repeat(4, 1fr);
            }
        }
        
        /* Desktop */
        @media (min-width: 1024px) {
            .container {
                max-width: 1500px;
                margin: 0 auto 40px;
            }
            
            .features {
                grid-template-columns: repeat(4, 1fr);
            }
            
            .notification {
                max-width: 400px;
            }
        }
    </style>
</head>
<body>
    <div class="particles" id="particles"></div>
    
    <header>
        <div class="logo">
            <div class="logo-icon">
                <i class="fas fa-project-diagram"></i>
            </div>
            <div>
                <h1>ArbPro</h1>
                <p class="subtitle">Advanced cryptocurrency arbitrage platform with proprietary algorithms</p>
            </div>
        </div>
        
        <div class="header-controls">
            <div class="refresh-indicator">
                <i class="fas fa-sync-alt"></i>
                <span>Auto-refresh: <span id="refresh-timer">30</span>s</span>
            </div>
            <button id="reset-btn" class="btn btn-warning">
                <i class="fas fa-redo"></i> Reset App
            </button>
        </div>
    </header>
    
    <div class="container">
        <div class="card">
            <div class="card-header">
                <h2 class="card-title"><i class="fas fa-search-dollar"></i> Advanced Arbitrage Scanner</h2>
                <div class="scan-status" id="scan-status">
                    <div class="spinner"></div>
                    <span id="scan-text">Ready to scan</span>
                </div>
            </div>
            
            <div class="controls">
                <div class="control-row">
                    <div class="control-group">
                        <label for="crypto-pair">
                            Crypto Pair
                            <i class="fas fa-info-circle info-icon" data-tooltip="Select cryptocurrency trading pair"></i>
                        </label>
                        <select id="crypto-pair">
                            <option value="BTC/USDT">BTC/USDT</option>
                            <option value="ETH/USDT" selected>ETH/USDT</option>
                            <option value="SOL/USD">SOL/USD</option>
                            <option value="BNB/USDT">BNB/USDT</option>
                            <option value="XRP/USDT">XRP/USDT</option>
                            <option value="ADA/USD">ADA/USD</option>
                            <option value="DOGE/USD">DOGE/USD</option>
                            <option value="DOT/USDT">DOT/USDT</option>
                            <option value="LTC/USD">LTC/USD</option>
                        </select>
                    </div>
                    
                    <div class="control-group">
                        <label for="min-profit">
                            Min Profit (%)
                            <i class="fas fa-info-circle info-icon" data-tooltip="Minimum profit percentage to show opportunities"></i>
                        </label>
                        <input type="number" id="min-profit" value="0.5" step="0.1" min="0">
                    </div>
                </div>
                
                <div class="control-row">
                    <div class="control-group">
                        <label for="fee-percentage">
                            Trading Fee (%)
                            <i class="fas fa-info-circle info-icon" data-tooltip="Your trading fee percentage on exchanges"></i>
                        </label>
                        <input type="number" id="fee-percentage" value="0.1" step="0.01" min="0">
                    </div>
                    
                    <div class="control-group">
                        <label for="transfer-fee">
                            Transfer Fee (%)
                            <i class="fas fa-info-circle info-icon" data-tooltip="Estimated network transfer fee"></i>
                        </label>
                        <input type="number" id="transfer-fee" value="0.05" step="0.01" min="0">
                    </div>
                </div>
                
                <div class="multi-leg-toggle">
                    <input type="checkbox" id="multi-leg" class="toggle-switch">
                    <label for="multi-leg">Enable Multi-Leg Arbitrage Detection</label>
                </div>
            </div>
            
            <div class="advanced-filters">
                <h3 style="margin-bottom: 15px;"><i class="fas fa-filter"></i> Advanced Filters</h3>
                <div class="filter-row">
                    <div class="filter-group">
                        <label for="min-liquidity">Min Liquidity ($)</label>
                        <input type="number" id="min-liquidity" value="100000" step="10000">
                    </div>
                    <div class="filter-group">
                        <label for="max-slippage">Max Slippage (%)</label>
                        <input type="number" id="max-slippage" value="0.5" step="0.1" min="0">
                    </div>
                </div>
                <div class="filter-row">
                    <div class="filter-group">
                        <label for="execution-speed">Execution Speed</label>
                        <select id="execution-speed">
                            <option value="fast">Fast (≤ 30s)</option>
                            <option value="medium" selected>Medium (≤ 2min)</option>
                            <option value="slow">Slow (≤ 5min)</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label for="risk-tolerance">Risk Tolerance</label>
                        <select id="risk-tolerance">
                            <option value="low">Low</option>
                            <option value="medium" selected>Medium</option>
                            <option value="high">High</option>
                        </select>
                    </div>
                </div>
            </div>
            
            <div class="btn-group">
                <button id="scan-btn" class="btn btn-primary">
                    <i class="fas fa-sync-alt"></i> Scan Arbitrage
                </button>
                
                <button id="export-csv" class="btn btn-outline">
                    <i class="fas fa-file-csv"></i> Export CSV
                </button>
                
                <button id="auto-scan" class="btn btn-success">
                    <i class="fas fa-play"></i> Auto Scan
                </button>
            </div>
            
            <div class="status-indicator">
                <div class="status-dot" id="status-dot"></div>
                <span id="status-text">Connected to live market data</span>
            </div>
            
            <div class="liquidity-map" id="liquidity-map">
                <!-- Liquidity visualization will be generated here -->
            </div>
            
            <div style="overflow-x: auto;">
                <table>
                    <thead>
                        <tr>
                            <th>Exchange</th>
                            <th>Price</th>
                            <th>Spread</th>
                            <th>Profit</th>
                            <th>Volume (24h)</th>
                            <th>Liquidity</th>
                            <th>Action</th>
                        </tr>
                    </thead>
                    <tbody id="exchange-data">
                        <tr>
                            <td colspan="7" style="text-align: center; padding: 30px;">
                                <i class="fas fa-search" style="font-size: 2rem; margin-bottom: 15px; color: #64748b;"></i>
                                <p>Click "Scan Arbitrage" to find opportunities</p>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
            
            <div class="path-visualization" id="path-visualization">
                <h3 style="margin-bottom: 15px;"><i class="fas fa-route"></i> Optimal Arbitrage Path</h3>
                <div id="path-content" style="text-align: center; padding: 10px;">
                    No path calculated yet
                </div>
            </div>
            
            <div class="opportunity-card">
                <div class="opportunity-header">
                    <h3>Best Opportunity</h3>
                    <span class="opportunity-badge badge-success">LIVE</span>
                </div>
                <div class="opportunity-content">
                    <div class="opportunity-item">
                        <span class="opportunity-label">Buy From</span>
                        <span class="opportunity-value" id="buy-exchange">-</span>
                    </div>
                    <div class="opportunity-item">
                        <span class="opportunity-label">Sell To</span>
                        <span class="opportunity-value" id="sell-exchange">-</span>
                    </div>
                    <div class="opportunity-item">
                        <span class="opportunity-label">Spread</span>
                        <span class="opportunity-value" id="spread-value">0.00%</span>
                    </div>
                    <div class="opportunity-item">
                        <span class="opportunity-label">Profit</span>
                        <span class="opportunity-value profit" id="profit-value">0.00%</span>
                    </div>
                    <div class="opportunity-item">
                        <span class="opportunity-label">Time Window</span>
                        <span class="opportunity-value" id="time-window">2-4 min</span>
                    </div>
                    <div class="opportunity-item">
                        <span class="opportunity-label">Success Probability</span>
                        <span class="opportunity-value" id="arb-success">87%</span>
                    </div>
                </div>
            </div>
            
            <div class="analytics-grid">
                <div class="analytics-card">
                    <span class="analytics-label">Total Opportunities</span>
                    <div class="analytics-value" id="total-opportunities">0</div>
                </div>
                <div class="analytics-card">
                    <span class="analytics-label">Avg. Profit</span>
                    <div class="analytics-value profit" id="avg-profit">0.00%</div>
                </div>
                <div class="analytics-card">
                    <span class="analytics-label">Max Profit</span>
                    <div class="analytics-value profit" id="max-profit">0.00%</div>
                </div>
                <div class="analytics-card">
                    <span class="analytics-label">Success Rate</span>
                    <div class="analytics-value" id="success-rate">0%</div>
                </div>
            </div>
        </div>
        
        <div class="card">
            <div class="card-header">
                <h2 class="card-title"><i class="fas fa-analytics"></i> Performance Analytics</h2>
            </div>
            
            <div class="controls">
                <div class="control-row">
                    <div class="control-group">
                        <label for="timeframe">Timeframe</label>
                        <select id="timeframe">
                            <option value="1h">Last Hour</option>
                            <option value="24h" selected>Last 24 Hours</option>
                            <option value="7d">Last 7 Days</option>
                            <option value="30d">Last 30 Days</option>
                        </select>
                    </div>
                    
                    <div class="control-group">
                        <label for="metric">Primary Metric</label>
                        <select id="metric">
                            <option value="profit" selected>Profit Percentage</option>
                            <option value="volume">Trading Volume</option>
                            <option value="frequency">Opportunity Frequency</option>
                        </select>
                    </div>
                </div>
            </div>
            
            <div class="chart-container">
                <canvas id="performance-chart"></canvas>
            </div>
            
            <div class="analytics-grid">
                <div class="analytics-card">
                    <span class="analytics-label">Total Scans</span>
                    <div class="analytics-value" id="total-scans">0</div>
                </div>
                <div class="analytics-card">
                    <span class="analytics-label">Profitable Scans</span>
                    <div class="analytics-value profit" id="profitable-scans">0</div>
                </div>
                <div class="analytics-card">
                    <span class="analytics-label">Avg. Execution Time</span>
                    <div class="analytics-value" id="avg-exec-time">0s</div>
                </div>
                <div class="analytics-card">
                    <span class="analytics-label">Best Pair</span>
                    <div class="analytics-value" id="best-pair">-</div>
                </div>
            </div>
            
            <div class="opportunity-card">
                <div class="opportunity-header">
                    <h3>Performance Insights</h3>
                    <span class="opportunity-badge badge-warning">ANALYSIS</span>
                </div>
                <div class="opportunity-content">
                    <div class="opportunity-item">
                        <span class="opportunity-label">Peak Hours</span>
                        <span class="opportunity-value" id="peak-hours">14:00-16:00 UTC</span>
                    </div>
                    <div class="opportunity-item">
                        <span class="opportunity-label">Most Profitable Exchange</span>
                        <span class="opportunity-value" id="best-exchange">-</span>
                    </div>
                    <div class="opportunity-item">
                        <span class="opportunity-label">Avg. Opportunity Duration</span>
                        <span class="opportunity-value" id="avg-opportunity-duration">0s</span>
                    </div>
                    <div class="opportunity-item">
                        <span class="opportunity-label">Market Efficiency Score</span>
                        <span class="opportunity-value" id="market-efficiency">0%</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <div class="features">
        <div class="feature">
            <i class="fas fa-bolt"></i>
            <h3>Real-Time Scanning</h3>
            <p>Proprietary algorithms continuously monitor exchanges for arbitrage opportunities with sub-second updates.</p>
        </div>
        <div class="feature">
            <i class="fas fa-robot"></i>
            <h3>Smart Routing</h3>
            <p>Our advanced pathfinding algorithm identifies the most efficient arbitrage routes across multiple exchanges.</p>
        </div>
        <div class="feature">
            <i class="fasfa-brain"></i>
            <h3>Predictive Analytics</h3>
            <p>Machine learning models predict price movements and identify opportunities before they become apparent.</p>
        </div>
        <div class="feature">
            <i class="fas fa-shield-alt"></i>
            <h3>Risk Assessment</h3>
            <p>Proprietary risk scoring system evaluates each opportunity based on liquidity, volatility, and execution probability.</p>
        </div>
    </div>
    
    <div class="disclaimer">
        <h3><i class="fas fa-exclamation-triangle"></i> Important Disclaimer</h3>
        <p>Crypto arbitrage involves significant risks. Prices are volatile and execution is not guaranteed. This tool is for informational purposes only and does not constitute financial advice. Always do your own research and understand the risks before trading.</p>
    </div>
    
    <div id="notification" class="notification">
        <i class="fas fa-bell"></i>
        <span id="notification-text">New arbitrage opportunity found!</span>
    </div>
    
    <div class="tooltip" id="tooltip"></div>
    
    <footer>
        <p>ArbPro - Advanced Crypto Arbitrage Platform | Proprietary Algorithms</p>
        <p>© 2023 ArbPro Technologies | All computations happen locally | Privacy Guaranteed</p>
    </footer>

    <script>
        // Initialize particles
        function createParticles() {
            const particlesContainer = document.getElementById('particles');
            const particleCount = 30;
            
            for (let i = 0; i < particleCount; i++) {
                const particle = document.createElement('div');
                particle.classList.add('particle');
                
                // Random position
                particle.style.left = `${Math.random() * 100}%`;
                particle.style.top = `${Math.random() * 100}%`;
                
                // Random size
                const size = Math.random() * 3 + 1;
                particle.style.width = `${size}px`;
                particle.style.height = `${size}px`;
                
                // Random animation delay
                particle.style.animationDelay = `${Math.random() * 15}s`;
                
                particlesContainer.appendChild(particle);
            }
        }
        
        // Define initial state for reset functionality
        const INITIAL_STATE = {
            cryptoPair: "ETH/USDT",
            minProfit: 0.5,
            feePercentage: 0.1,
            transferFee: 0.05,
            minLiquidity: 100000,
            maxSlippage: 0.5,
            executionSpeed: "medium",
            riskTolerance: "medium",
            multiLeg: false,
            timeframe: "24h",
            metric: "profit"
        };

        // Enhanced exchange API endpoints with more exchanges
        const EXCHANGE_APIS = {
            'Binance': {
                'BTC/USDT': 'https://api.binance.com/api/v3/ticker/price?symbol=BTCUSDT',
                'ETH/USDT': 'https://api.binance.com/api/v3/ticker/price?symbol=ETHUSDT',
                'SOL/USD': 'https://api.binance.com/api/v3/ticker/price?symbol=SOLUSDT',
                'BNB/USDT': 'https://api.binance.com/api/v3/ticker/price?symbol=BNBUSDT',
                'XRP/USDT': 'https://api.binance.com/api/v3/ticker/price?symbol=XRPUSDT',
                'ADA/USD': 'https://api.binance.com/api/v3/ticker/price?symbol=ADAUSDT',
                'DOGE/USD': 'https://api.binance.com/api/v3/ticker/price?symbol=DOGEUSDT',
                'DOT/USDT': 'https://api.binance.com/api/v3/ticker/price?symbol=DOTUSDT',
                'LTC/USD': 'https://api.binance.com/api/v3/ticker/price?symbol=LTCUSDT'
            },
            'Coinbase': {
                'BTC/USDT': 'https://api.coinbase.com/v2/prices/BTC-USD/spot',
                'ETH/USDT': 'https://api.coinbase.com/v2/prices/ETH-USD/spot',
                'SOL/USD': 'https://api.coinbase.com/v2/prices/SOL-USD/spot',
                'XRP/USDT': 'https://api.coinbase.com/v2/prices/XRP-USD/spot',
                'ADA/USD': 'https://api.coinbase.com/v2/prices/ADA-USD/spot',
                'DOGE/USD': 'https://api.coinbase.com/v2/prices/DOGE-USD/spot',
                'DOT/USDT': 'https://api.coinbase.com/v2/prices/DOT-USD/spot',
                'LTC/USD': 'https://api.coinbase.com/v2/prices/LTC-USD/spot'
            },
            'Kraken': {
                'BTC/USDT': 'https://api.kraken.com/0/public/Ticker?pair=XBTUSDT',
                'ETH/USDT': 'https://api.kraken.com/0/public/Ticker?pair=ETHUSDT',
                'SOL/USD': 'https://api.kraken.com/0/public/Ticker?pair=SOLUSD',
                'BNB/USDT': 'https://api.kraken.com/0/public/Ticker?pair=BNBUSDT',
                'XRP/USDT': 'https://api.kraken.com/0/public/Ticker?pair=XRPUSDT',
                'ADA/USD': 'https://api.kraken.com/0/public/Ticker?pair=ADAUSD',
                'DOGE/USD': 'https://api.kraken.com/0/public/Ticker?pair=DOGEUSD',
                'DOT/USDT': 'https://api.kraken.com/0/public/Ticker?pair=DOTUSDT',
                'LTC/USD': 'https://api.kraken.com/0/public/Ticker?pair=LTCUSD'
            },
            'KuCoin': {
                'BTC/USDT': 'https://api.kucoin.com/api/v1/market/orderbook/level1?symbol=BTC-USDT',
                'ETH/USDT': 'https://api.kucoin.com/api/v1/market/orderbook/level1?symbol=ETH-USDT',
                'SOL/USD': 'https://api.kucoin.com/api/v1/market/orderbook/level1?symbol=SOL-USDT',
                'BNB/USDT': 'https://api.kucoin.com/api/v1/market/orderbook/level1?symbol=BNB-USDT',
                'XRP/USDT': 'https://api.kucoin.com/api/v1/market/orderbook/level1?symbol=XRP-USDT',
                'ADA/USD': 'https://api.kucoin.com/api/v1/market/orderbook/level1?symbol=ADA-USDT',
                'DOGE/USD': 'https://api.kucoin.com/api/v1/market/orderbook/level1?symbol=DOGE-USDT',
                'DOT/USDT': 'https://api.kucoin.com/api/v1/market/orderbook/level1?symbol=DOT-USDT',
                'LTC/USD': 'https://api.kucoin.com/api/v1/market/orderbook/level1?symbol=LTC-USDT'
            },
            'HTX': {
                'BTC/USDT': 'https://api.huobi.pro/market/detail/merged?symbol=btcusdt',
                'ETH/USDT': 'https://api.huobi.pro/market/detail/merged?symbol=ethusdt',
                'SOL/USD': 'https://api.huobi.pro/market/detail/merged?symbol=solusdt',
                'BNB/USDT': 'https://api.huobi.pro/market/detail/merged?symbol=bnbusdt',
                'XRP/USDT': 'https://api.huobi.pro/market/detail/merged?symbol=xrpusdt',
                'ADA/USD': 'https://api.huobi.pro/market/detail/merged?symbol=adausdt',
                'DOGE/USD': 'https://api.huobi.pro/market/detail/merged?symbol=dogeusdt',
                'DOT/USDT': 'https://api.huobi.pro/market/detail/merged?symbol=dotusdt',
                'LTC/USD': 'https://api.huobi.pro/market/detail/merged?symbol=ltcusdt'
            },
            'OKX': {
                'BTC/USDT': 'https://www.okx.com/api/v5/market/ticker?instId=BTC-USDT',
                'ETH/USDT': 'https://www.okx.com/api/v5/market/ticker?instId=ETH-USDT',
                'SOL/USD': 'https://www.okx.com/api/v5/market/ticker?instId=SOL-USDT',
                'BNB/USDT': 'https://www.okx.com/api/v5/market/ticker?instId=BNB-USDT',
                'XRP/USDT': 'https://www.okx.com/api/v5/market/ticker?instId=XRP-USDT',
                'ADA/USD': 'https://www.okx.com/api/v5/market/ticker?instId=ADA-USDT',
                'DOGE/USD': 'https://www.okx.com/api/v5/market/ticker?instId=DOGE-USDT',
                'DOT/USDT': 'https://www.okx.com/api/v5/market/ticker?instId=DOT-USDT',
                'LTC/USD': 'https://www.okx.com/api/v5/market/ticker?instId=LTC-USDT'
            }
        };
        
        // Exchange data cache with enhanced properties
        const exchangeData = {
            'Binance': { price: 0, volume: 0, liquidity: 0, lastUpdated: 0, latency: 0 },
            'Coinbase': { price: 0, volume: 0, liquidity: 0, lastUpdated: 0, latency: 0 },
            'Kraken': { price: 0, volume: 0, liquidity: 0, lastUpdated: 0, latency: 0 },
            'KuCoin': { price: 0, volume: 0, liquidity: 0, lastUpdated: 0, latency: 0 },
            'HTX': { price: 0, volume: 0, liquidity: 0, lastUpdated: 0, latency: 0 },
            'OKX': { price: 0, volume: 0, liquidity: 0, lastUpdated: 0, latency: 0 }
        };
        
        // Performance tracking
        const performanceData = {
            totalScans: 0,
            profitableScans: 0,
            opportunitiesFound: 0,
            totalProfit: 0,
            maxProfit: 0,
            bestPair: '',
            bestExchange: '',
            executionTimes: [],
            opportunityDurations: [],
            scanHistory: []
        };
        
        // Chart instances
        let performanceChart = null;
        let autoScanInterval = null;
        let refreshTimer = 30;
        let refreshInterval = null;
        
        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            createParticles();
            initPerformanceChart();
            setupEventListeners();
            initTooltips();
            renderLiquidityMap();
            
            // Request notification permission
            if (Notification.permission !== 'granted') {
                Notification.requestPermission();
            }
            
            // Load initial data
            fetchMarketData();
            
            // Start refresh timer
            startRefreshTimer();
            
            // Load performance data from localStorage
            loadPerformanceData();
        });
        
        function setupEventListeners() {
            document.getElementById('scan-btn').addEventListener('click', scanArbitrage);
            document.getElementById('export-csv').addEventListener('click', exportCSV);
            document.getElementById('crypto-pair').addEventListener('change', resetOpportunityData);
            document.getElementById('auto-scan').addEventListener('click', toggleAutoScan);
            document.getElementById('reset-btn').addEventListener('click', resetApplication);
            document.getElementById('timeframe').addEventListener('change', updatePerformanceChart);
            document.getElementById('metric').addEventListener('change', updatePerformanceChart);
            document.getElementById('multi-leg').addEventListener('change', toggleMultiLegArbitrage);
        }
        
        function initTooltips() {
            const infoIcons = document.querySelectorAll('.info-icon');
            const tooltip = document.getElementById('tooltip');
            
            infoIcons.forEach(icon => {
                icon.addEventListener('mouseover', function(e) {
                    const rect = e.target.getBoundingClientRect();
                    tooltip.style.display = 'block';
                    tooltip.style.top = (rect.bottom + window.scrollY) + 'px';
                    tooltip.style.left = rect.left + 'px';
                    tooltip.textContent = e.target.dataset.tooltip;
                });
                
                icon.addEventListener('mouseout', function() {
                    tooltip.style.display = 'none';
                });
            });
        }
        
        function startRefreshTimer() {
            clearInterval(refreshInterval);
            refreshInterval = setInterval(() => {
                refreshTimer--;
                document.getElementById('refresh-timer').textContent = refreshTimer;
                
                if (refreshTimer <= 0) {
                    refreshTimer = 30;
                    fetchMarketData();
                }
            }, 1000);
        }
        
        function initPerformanceChart() {
            const ctx = document.getElementById('performance-chart').getContext('2d');
            
            performanceChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: Array.from({length: 24}, (_, i) => `${i}:00`),
                    datasets: [{
                        label: 'Profit Opportunities',
                        data: Array.from({length: 24}, () => Math.random() * 10),
                        borderColor: '#10b981',
                        backgroundColor: 'rgba(16, 185, 129, 0.1)',
                        borderWidth: 2,
                        fill: true,
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            grid: {
                                color: 'rgba(148, 163, 184, 0.1)'
                            },
                            ticks: {
                                color: '#94a3b8'
                            }
                        },
                        x: {
                            grid: {
                                display: false
                            },
                            ticks: {
                                color: '#94a3b8'
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            labels: {
                                color: '#e2e8f0'
                            }
                        },
                        tooltip: {
                            backgroundColor: 'rgba(30, 41, 59, 0.9)',
                            titleColor: '#f8fafc',
                            bodyColor: '#e2e8f0',
                            borderColor: 'rgba(148, 163, 184, 0.2)',
                            borderWidth: 1
                        }
                    }
                }
            });
        }
        
        function updatePerformanceChart() {
            const timeframe = document.getElementById('timeframe').value;
            const metric = document.getElementById('metric').value;
            
            // Generate mock data based on timeframe and metric
            let labels = [];
            let data = [];
            
            if (timeframe === '1h') {
                labels = Array.from({length: 12}, (_, i) => `${i * 5} min`);
                data = Array.from({length: 12}, () => Math.random() * 10);
            } else if (timeframe === '24h') {
                labels = Array.from({length: 24}, (_, i) => `${i}:00`);
                data = Array.from({length: 24}, () => Math.random() * 10);
            } else if (timeframe === '7d') {
                labels = ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'];
                data = Array.from({length: 7}, () => Math.random() * 10);
            } else if (timeframe === '30d') {
                labels = Array.from({length: 30}, (_, i) => `Day ${i + 1}`);
                data = Array.from({length: 30}, () => Math.random() * 10);
            }
            
            performanceChart.data.labels = labels;
            performanceChart.data.datasets[0].data = data;
            
            if (metric === 'profit') {
                performanceChart.data.datasets[0].label = 'Profit Percentage';
                performanceChart.data.datasets[0].borderColor = '#10b981';
                performanceChart.data.datasets[0].backgroundColor = 'rgba(16, 185, 129, 0.1)';
            } else if (metric === 'volume') {
                performanceChart.data.datasets[0].label = 'Trading Volume (M)';
                performanceChart.data.datasets[0].borderColor = '#3b82f6';
                performanceChart.data.datasets[0].backgroundColor = 'rgba(59, 130, 246, 0.1)';
            } else if (metric === 'frequency') {
                performanceChart.data.datasets[0].label = 'Opportunity Frequency';
                performanceChart.data.datasets[0].borderColor = '#8b5cf6';
                performanceChart.data.datasets[0].backgroundColor = 'rgba(139, 92, 246, 0.1)';
            }
            
            performanceChart.update();
        }
        
        function renderLiquidityMap() {
            const mapContainer = document.getElementById('liquidity-map');
            mapContainer.innerHTML = '';
            
            const exchanges = Object.keys(exchangeData);
            const width = mapContainer.offsetWidth;
            const height = mapContainer.offsetHeight;
            
            // Position exchanges in a circle
            exchanges.forEach((exchange, index) => {
                const angle = (index / exchanges.length) * 2 * Math.PI;
                const x = width / 2 + (width / 3) * Math.cos(angle);
                const y = height / 2 + (height / 3) * Math.sin(angle);
                
                const node = document.createElement('div');
                node.classList.add('liquidity-node');
                node.style.left = `${x}px`;
                node.style.top = `${y}px`;
                node.textContent = exchange.charAt(0);
                node.title = exchange;
                
                mapContainer.appendChild(node);
            });
            
            // Draw connections between exchanges
            for (let i = 0; i < exchanges.length; i++) {
                for (let j = i + 1; j < exchanges.length; j++) {
                    const angle1 = (i / exchanges.length) * 2 * Math.PI;
                    const x1 = width / 2 + (width / 3) * Math.cos(angle1);
                    const y1 = height / 2 + (height / 3) * Math.sin(angle1);
                    
                    const angle2 = (j / exchanges.length) * 2 * Math.PI;
                    const x2 = width / 2 + (width / 3) * Math.cos(angle2);
                    const y2 = height / 2 + (height / 3) * Math.sin(angle2);
                    
                    const dx = x2 - x1;
                    const dy = y2 - y1;
                    const length = Math.sqrt(dx * dx + dy * dy);
                    const angle = Math.atan2(dy, dx) * 180 / Math.PI;
                    
                    const connection = document.createElement('div');
                    connection.classList.add('liquidity-connection');
                    connection.style.width = `${length}px`;
                    connection.style.left = `${x1}px`;
                    connection.style.top = `${y1}px`;
                    connection.style.transform = `rotate(${angle}deg)`;
                    connection.style.opacity = '0.3';
                    
                    mapContainer.appendChild(connection);
                }
            }
        }
        
        // Fetch market data from exchanges
        async function fetchMarketData() {
            const pair = document.getElementById('crypto-pair').value;
            
            // Show scanning status
            document.getElementById('scan-text').textContent = "Updating market data...";
            document.getElementById('scan-status').style.display = 'flex';
            
            try {
                // Fetch data from each exchange in parallel
                const exchangePromises = Object.keys(EXCHANGE_APIS).map(async exchange => {
                    const apiUrl = EXCHANGE_APIS[exchange][pair];
                    if (!apiUrl) return;
                    
                    try {
                        const startTime = Date.now();
                        const response = await fetch(apiUrl);
                        const endTime = Date.now();
                        
                        if (!response.ok) throw new Error('API error');
                        
                        const data = await response.json();
                        let price = 0;
                        
                        // Parse response based on exchange
                        if (exchange === 'Binance') {
                            price = parseFloat(data.price);
                        } else if (exchange === 'Coinbase') {
                            price = parseFloat(data.data.amount);
                        } else if (exchange === 'Kraken') {
                            const tickerKey = Object.keys(data.result)[0];
                            price = parseFloat(data.result[tickerKey].c[0]);
                        } else if (exchange === 'KuCoin') {
                            price = parseFloat(data.data.price);
                        } else if (exchange === 'HTX') {
                            price = parseFloat(data.tick.close);
                        } else if (exchange === 'OKX') {
                            price = parseFloat(data.data[0].last);
                        }
                        
                        if (price > 0) {
                            exchangeData[exchange].price = price;
                            exchangeData[exchange].lastUpdated = Date.now();
                            exchangeData[exchange].latency = endTime - startTime;
                            // Simulate volume and liquidity (real APIs would require separate endpoint)
                            exchangeData[exchange].volume = (10000000 + Math.random() * 50000000).toFixed(0);
                            exchangeData[exchange].liquidity = (5000000 + Math.random() * 20000000).toFixed(0);
                        }
                    } catch (error) {
                        console.error(`Error fetching from ${exchange}:`, error);
                    }
                });
                
                await Promise.all(exchangePromises);
                updateStatus(true);
                document.getElementById('scan-text').textContent = "Market data updated";
                setTimeout(() => {
                    document.getElementById('scan-status').style.display = 'none';
                }, 2000);
            } catch (error) {
                console.error('Error fetching market data:', error);
                updateStatus(false, 'Error fetching data. Retrying...');
                document.getElementById('scan-text').textContent = "Data update failed";
                setTimeout(() => {
                    document.getElementById('scan-status').style.display = 'none';
                }, 2000);
            }
        }
        
        function updateStatus(connected, message = '') {
            const statusDot = document.getElementById('status-dot');
            const statusText = document.getElementById('status-text');
            
            if (connected) {
                statusDot.className = 'status-dot';
                statusText.textContent = message || 'Connected to live market data';
                statusText.style.color = '#94a3b8';
            } else {
                statusDot.className = 'status-dot offline';
                statusText.textContent = message || 'Offline. Using cached data.';
                statusText.style.color = '#ef4444';
            }
        }
        
        async function scanArbitrage() {
            const startTime = Date.now();
            const pair = document.getElementById('crypto-pair').value;
            const feePercentage = parseFloat(document.getElementById('fee-percentage').value) || 0.1;
            const transferFee = parseFloat(document.getElementById('transfer-fee').value) || 0.05;
            const minProfit = parseFloat(document.getElementById('min-profit').value) || 0.5;
            const minLiquidity = parseFloat(document.getElementById('min-liquidity').value) || 100000;
            const multiLeg = document.getElementById('multi-leg').checked;
            
            // Show scanning status
            document.getElementById('scan-text').textContent = "Scanning exchanges...";
            document.getElementById('scan-status').style.display = 'flex';
            
            await fetchMarketData();
            refreshTimer = 30; // Reset timer after manual scan
            
            // Filter out exchanges without data or below liquidity threshold
            const activeExchanges = Object.entries(exchangeData)
                .filter(([_, data]) => data.price > 0 && data.liquidity >= minLiquidity)
                .map(([name, data]) => ({ 
                    name, 
                    price: data.price, 
                    volume: data.volume,
                    liquidity: data.liquidity,
                    latency: data.latency
                }));
            
            if (activeExchanges.length < 2) {
                showNotification("Not enough exchange data available. Try again later.", "warning");
                document.getElementById('scan-text').textContent = "Scan failed - not enough data";
                setTimeout(() => {
                    document.getElementById('scan-status').style.display = 'none';
                }, 2000);
                return;
            }
            
            // Sort by price (lowest to highest)
            activeExchanges.sort((a, b) => a.price - b.price);
            
            // Calculate spread and profit
            const lowest = activeExchanges[0];
            const highest = activeExchanges[activeExchanges.length - 1];
            
            // Spread = (highest price - lowest price) / lowest price
            const spread = ((highest.price - lowest.price) / lowest.price) * 100;
            
            // Profit = spread - (2 * feePercentage) - transferFee
            const profit = spread - (2 * feePercentage) - transferFee;
            
            // Update performance tracking
            performanceData.totalScans++;
            if (profit > minProfit) {
                performanceData.profitableScans++;
                performanceData.opportunitiesFound++;
                performanceData.totalProfit += profit;
                
                if (profit > performanceData.maxProfit) {
                    performanceData.maxProfit = profit;
                    performanceData.bestPair = pair;
                    performanceData.bestExchange = lowest.name;
                }
                
                // Add to scan history
                performanceData.scanHistory.push({
                    timestamp: Date.now(),
                    pair,
                    profit,
                    buyExchange: lowest.name,
                    sellExchange: highest.name
                });
            }
            
            const endTime = Date.now();
            performanceData.executionTimes.push(endTime - startTime);
            
            // Update the table
            renderExchangeTable(activeExchanges, feePercentage, transferFee, lowest.price);
            
            // Update opportunity card
            document.getElementById('buy-exchange').textContent = `${lowest.name}: $${lowest.price.toFixed(2)}`;
            document.getElementById('sell-exchange').textContent = `${highest.name}: $${highest.price.toFixed(2)}`;
            document.getElementById('spread-value').textContent = `${spread.toFixed(2)}%`;
            document.getElementById('profit-value').textContent = `${profit.toFixed(2)}%`;
            
            // Calculate time window based on profit and volatility
            const timeWindow = profit > 1.5 ? "1-2 min" : profit > 0.8 ? "2-4 min" : "4-8 min";
            document.getElementById('time-window').textContent = timeWindow;
            
            // Calculate success probability
            const successProb = Math.min(95, Math.max(60, profit * 25));
            document.getElementById('arb-success').textContent = `${successProb.toFixed(0)}%`;
            
            // Update analytics
            updateAnalytics(activeExchanges, profit);
            
            // Update path visualization
            updatePathVisualization(lowest, highest);
            
            // Show notification if significant opportunity
            if (profit > minProfit) {
                showNotification(`Arbitrage opportunity: ${profit.toFixed(2)}% profit on ${pair}`);
                
                // Browser notification
                if (Notification.permission === 'granted') {
                    new Notification('ArbPro Opportunity', {
                        body: `${profit.toFixed(2)}% profit on ${pair}\nBuy on ${lowest.name} at $${lowest.price.toFixed(2)}\nSell on ${highest.name} at $${highest.price.toFixed(2)}`,
                        icon: 'data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0iIzI1NjNlYiI+PHBhdGggZD0iTTEzLjc4OCw1LjQ4NEMxNC40NDUsNC44MjcgMTUuNTU1LDQuODI3IDE2LjIxMiw1LjQ4NGw1LjMwNyw1LjMwN2MxLjMxLDEuMzEgMS4zMSwzLjQzNiAwLDQuNzQ2bC01LjMwNyw1LjMwN2MtMC42NTcsMC42NTctMS43NjcsMC42NTctMi40MjQsMEwxMy43ODgsMTUuNUg1Yy0xLjEwMywwLTItMC44OTctMi0ydi0zYzAtMS4xMDMsMC44OTctMiwyLTJoOC43ODhMMTMuNzg4LDUuNDg0eiIvPjwvc3ZnPg=='
                    });
                }
            }
            
            // Update scan status
            document.getElementById('scan-text').textContent = "Scan completed!";
            setTimeout(() => {
                document.getElementById('scan-status').style.display = 'none';
            }, 2000);
            
            // Save performance data
            savePerformanceData();
        }
        
        function renderExchangeTable(exchanges, feePercentage, transferFee, lowestPrice) {
            const tableBody = document.getElementById('exchange-data');
            tableBody.innerHTML = '';
            
            let totalProfit = 0;
            let maxProfit = 0;
            let opportunityCount = 0;
            
            exchanges.forEach(exchange => {
                const row = document.createElement('tr');
                
                // Calculate spread relative to lowest price
                const spread = ((exchange.price - lowestPrice) / lowestPrice) * 100;
                
                // Calculate profit (spread - 2*fees - transfer cost)
                const profit = spread - (2 * feePercentage) - transferFee;
                
                // Update analytics values
                totalProfit += profit;
                if (profit > maxProfit) maxProfit = profit;
                if (profit > parseFloat(document.getElementById('min-profit').value)) opportunityCount++;
                
                // Determine profit/loss class
                const profitClass = profit > 0.5 ? 'profit' : (profit > 0 ? '' : 'loss');
                
                // Format volume and liquidity
                const volume = exchange.volume > 1000000 
                    ? `$${(exchange.volume / 1000000).toFixed(2)}M` 
                    : `$${(exchange.volume / 1000).toFixed(1)}K`;
                    
                const liquidity = exchange.liquidity > 1000000 
                    ? `$${(exchange.liquidity / 1000000).toFixed(2)}M` 
                    : `$${(exchange.liquidity / 1000).toFixed(1)}K`;
                
                row.innerHTML = `
                    <td>${exchange.name}</td>
                    <td>$${exchange.price.toFixed(2)}</td>
                    <td>${spread.toFixed(2)}%</td>
                    <td class="${profitClass}">${profit.toFixed(2)}%</td>
                    <td>${volume}</td>
                    <td>${liquidity}</td>
                    <td>
                        <button class="btn btn-outline" style="padding: 5px 10px; font-size: 0.8rem;">
                            <i class="fas fa-external-link-alt"></i> Trade
                        </button>
                    </td>
                `;
                
                tableBody.appendChild(row);
            });
            
            // Update opportunity count
            document.getElementById('total-opportunities').textContent = opportunityCount;
        }
        
        function updateAnalytics(exchanges, profit) {
            // Calculate average profit
            const minProfitValue = parseFloat(document.getElementById('min-profit').value) || 0.5;
            const profitableExchanges = exchanges.filter(e => {
                const spread = ((e.price - exchanges[0].price) / exchanges[0].price) * 100;
                const calculatedProfit = spread - (2 * 0.1) - 0.05; // Using default fees for calculation
                return calculatedProfit > minProfitValue;
            });
            
            const avgProfit = profitableExchanges.length > 0 
                ? profitableExchanges.reduce((sum, e) => {
                    const spread = ((e.price - exchanges[0].price) / exchanges[0].price) * 100;
                    return sum + (spread - (2 * 0.1) - 0.05);
                }, 0) / profitableExchanges.length 
                : 0;
            
            // Update analytics cards
            document.getElementById('avg-profit').textContent = `${avgProfit.toFixed(2)}%`;
            document.getElementById('max-profit').textContent = `${profit.toFixed(2)}%`;
            
            // Calculate success rate
            const successRate = performanceData.totalScans > 0 
                ? (performanceData.profitableScans / performanceData.totalScans * 100).toFixed(0) 
                : 0;
            document.getElementById('success-rate').textContent = `${successRate}%`;
            
            // Update performance analytics
            const avgExecTime = performanceData.executionTimes.length > 0 
                ? (performanceData.executionTimes.reduce((a, b) => a + b, 0) / performanceData.executionTimes.length / 1000).toFixed(1)
                : 0;
                
            document.getElementById('total-scans').textContent = performanceData.totalScans;
            document.getElementById('profitable-scans').textContent = performanceData.profitableScans;
            document.getElementById('avg-exec-time').textContent = `${avgExecTime}s`;
            document.getElementById('best-pair').textContent = performanceData.bestPair || '-';
            
            // Update insights
            document.getElementById('best-exchange').textContent = performanceData.bestExchange || '-';
            
            const avgOpportunityDuration = performanceData.opportunityDurations.length > 0
                ? `${(performanceData.opportunityDurations.reduce((a, b) => a + b, 0) / performanceData.opportunityDurations.length / 1000).toFixed(1)}s`
                : '0s';
            document.getElementById('avg-opportunity-duration').textContent = avgOpportunityDuration;
            
            // Calculate market efficiency score (mock)
            const marketEfficiency = Math.max(10, 100 - (performanceData.totalScans > 0 ? performanceData.profitableScans / performanceData.totalScans * 100 : 0));
            document.getElementById('market-efficiency').textContent = `${marketEfficiency.toFixed(0)}%`;
        }
        
        function updatePathVisualization(lowest, highest) {
            const pathContent = document.getElementById('path-content');
            
            pathContent.innerHTML = `
                <div class="path-node">${lowest.name} (Buy)</div>
                <span class="path-arrow"><i class="fas fa-arrow-right"></i></span>
                <div class="path-node">Transfer</div>
                <span class="path-arrow"><i class="fas fa-arrow-right"></i></span>
                <div class="path-node">${highest.name} (Sell)</div>
            `;
        }
        
        function toggleMultiLegArbitrage() {
            const multiLeg = document.getElementById('multi-leg').checked;
            
            if (multiLeg) {
                showNotification("Multi-leg arbitrage detection enabled");
                // In a real application, this would enable more complex algorithms
            } else {
                showNotification("Multi-leg arbitrage detection disabled");
            }
        }
        
        function showNotification(message, type = "success") {
            const notification = document.getElementById('notification');
            const notificationText = document.getElementById('notification-text');
            
            notificationText.textContent = message;
            notification.className = `notification show ${type}`;
            
            setTimeout(() => {
                notification.className = "notification";
            }, 5000);
        }
        
        function exportCSV() {
            const pair = document.getElementById('crypto-pair').value;
            const now = new Date();
            const timestamp = now.toISOString().replace(/[:.]/g, '-');
            const filename = `arbpro-${pair}-${timestamp}.csv`;
            
            // Create CSV content
            let csvContent = "Exchange,Price,Spread,Profit,Volume,Liquidity\n";
            const rows = document.querySelectorAll('#exchange-data tr');
            
            rows.forEach(row => {
                const cells = row.querySelectorAll('td');
                if (cells.length >= 6) {
                    const exchange = cells[0].textContent;
                    const price = cells[1].textContent.replace('$', '');
                    const spread = cells[2].textContent.replace('%', '');
                    const profit = cells[3].textContent.replace('%', '');
                    const volume = cells[4].textContent;
                    const liquidity = cells[5].textContent;
                    csvContent += `"${exchange}",${price},${spread},${profit},"${volume}","${liquidity}"\n`;
                }
            });
            
            // Create download link
            const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            const url = URL.createObjectURL(blob);
            link.setAttribute('href', url);
            link.setAttribute('download', filename);
            link.style.visibility = 'hidden';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            showNotification(`CSV exported: ${filename}`);
        }
        
        function toggleAutoScan() {
            const autoScanBtn = document.getElementById('auto-scan');
            
            if (autoScanInterval) {
                clearInterval(autoScanInterval);
                autoScanInterval = null;
                autoScanBtn.innerHTML = '<i class="fas fa-play"></i> Auto Scan';
                autoScanBtn.classList.remove('btn-outline');
                autoScanBtn.classList.add('btn-success');
                showNotification("Auto scan disabled");
            } else {
                autoScanInterval = setInterval(() => {
                    scanArbitrage();
                }, 30000);
                autoScanBtn.innerHTML = '<i class="fas fa-stop"></i> Stop Scan';
                autoScanBtn.classList.remove('btn-success');
                autoScanBtn.classList.add('btn-outline');
                showNotification("Auto scan enabled - scanning every 30 seconds");
                scanArbitrage(); // Run immediately
            }
        }
        
        function resetOpportunityData() {
            document.getElementById('buy-exchange').textContent = '-';
            document.getElementById('sell-exchange').textContent = '-';
            document.getElementById('spread-value').textContent = '0.00%';
            document.getElementById('profit-value').textContent = '0.00%';
            
            if (autoScanInterval) {
                clearInterval(autoScanInterval);
                autoScanInterval = null;
                document.getElementById('auto-scan').innerHTML = '<i class="fas fa-play"></i> Auto Scan';
                document.getElementById('auto-scan').classList.remove('btn-outline');
                document.getElementById('auto-scan').classList.add('btn-success');
            }
        }
        
        function loadPerformanceData() {
            const savedData = localStorage.getItem('arbProPerformanceData');
            if (savedData) {
                try {
                    const data = JSON.parse(savedData);
                    Object.assign(performanceData, data);
                } catch (e) {
                    console.error('Error loading performance data:', e);
                }
            }
        }
        
        function savePerformanceData() {
            try {
                localStorage.setItem('arbProPerformanceData', JSON.stringify(performanceData));
            } catch (e) {
                console.error('Error saving performance data:', e);
            }
        }
        
        // Reset application to initial state
        function resetApplication() {
            // Stop auto-scan if running
            if (autoScanInterval) {
                clearInterval(autoScanInterval);
                autoScanInterval = null;
                document.getElementById('auto-scan').innerHTML = '<i class="fas fa-play"></i> Auto Scan';
                document.getElementById('auto-scan').classList.remove('btn-outline');
                document.getElementById('auto-scan').classList.add('btn-success');
            }
            
            // Reset form inputs to initial values
            document.getElementById('crypto-pair').value = INITIAL_STATE.cryptoPair;
            document.getElementById('min-profit').value = INITIAL_STATE.minProfit;
            document.getElementById('fee-percentage').value = INITIAL_STATE.feePercentage;
            document.getElementById('transfer-fee').value = INITIAL_STATE.transferFee;
            document.getElementById('min-liquidity').value = INITIAL_STATE.minLiquidity;
            document.getElementById('max-slippage').value = INITIAL_STATE.maxSlippage;
            document.getElementById('execution-speed').value = INITIAL_STATE.executionSpeed;
            document.getElementById('risk-tolerance').value = INITIAL_STATE.riskTolerance;
            document.getElementById('multi-leg').checked = INITIAL_STATE.multiLeg;
            document.getElementById('timeframe').value = INITIAL_STATE.timeframe;
            document.getElementById('metric').value = INITIAL_STATE.metric;
            
            // Reset table and opportunity data
            document.getElementById('exchange-data').innerHTML = `
                <tr>
                    <td colspan="7" style="text-align: center; padding: 30px;">
                        <i class="fas fa-search" style="font-size: 2rem; margin-bottom: 15px; color: #64748b;"></i>
                        <p>Click "Scan Arbitrage" to find opportunities</p>
                    </td>
                </tr>
            `;
            
            resetOpportunityData();
            
            // Reset performance chart
            updatePerformanceChart();
            
            // Reset status indicator
            updateStatus(true, 'Connected to live market data');
            
            // Reset refresh timer
            refreshTimer = 30;
            document.getElementById('refresh-timer').textContent = refreshTimer;
            
            // Hide scan status
            document.getElementById('scan-status').style.display = 'none';
            
            // Reset path visualization
            document.getElementById('path-content').innerHTML = 'No path calculated yet';
            
            // Reset analytics
            document.getElementById('total-opportunities').textContent = '0';
            document.getElementById('avg-profit').textContent = '0.00%';
            document.getElementById('max-profit').textContent = '0.00%';
            document.getElementById('success-rate').textContent = '0%';
            
            // Show reset notification
            showNotification("Application has been reset to initial state");
        }
    </script>
</body>
</html>
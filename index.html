<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ArbMatrix Pro | Advanced Crypto Arbitrage Platform</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            --primary: #3a86ff;
            --primary-light: #5fa3ff;
            --primary-dark: #2667cc;
            --secondary: #1e293b;
            --success: #10b981;
            --success-dark: #059669;
            --warning: #f59e0b;
            --danger: #ef4444;
            --dark: #0f172a;
            --darker: #0b1120;
            --light: #f8fafc;
            --gray: #64748b;
            --card-bg: rgba(255, 255, 255, 0.95);
            --card-border: rgba(203, 213, 225, 0.6);
            --card-hover: rgba(255, 255, 255, 0.98);
            --text-primary: #1e293b;
            --text-secondary: #475569;
            --text-muted: #64748b;
            --bg-primary: #f1f5f9;
            --bg-secondary: #e2e8f0;
            --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            --gradient-start: #3a86ff;
            --gradient-end: #8338ec;
        }

        .dark-mode {
            --primary: #3a86ff;
            --primary-light: #5fa3ff;
            --primary-dark: #2667cc;
            --secondary: #334155;
            --success: #10b981;
            --success-dark: #059669;
            --warning: #f59e0b;
            --danger: #ef4444;
            --dark: #0f172a;
            --darker: #0b1120;
            --light: #f8fafc;
            --gray: #94a3b8;
            --card-bg: rgba(30, 41, 59, 0.85);
            --card-border: rgba(148, 163, 184, 0.25);
            --card-hover: rgba(30, 41, 59, 0.95);
            --text-primary: #f1f5f9;
            --text-secondary: #e2e8f0;
            --text-muted: #94a3b8;
            --bg-primary: #0f172a;
            --bg-secondary: #1e293b;
            --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.3), 0 2px 4px -1px rgba(0, 0, 0, 0.2);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.3), 0 4px 6px -2px rgba(0, 0, 0, 0.2);
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', 'SF Pro Display', -apple-system, system-ui, sans-serif;
        }
        
        body {
            background-color: var(--bg-primary);
            color: var(--text-primary);
            min-height: 100vh;
            padding: 15px;
            line-height: 1.6;
            font-size: 16px;
            position: relative;
            overflow-x: hidden;
            transition: background-color 0.3s ease, color 0.3s ease;
        }
        
        .app-container {
            max-width: 1400px;
            margin: 0 auto;
        }
        
        /* Header Styles */
        header {
            text-align: center;
            margin-bottom: 25px;
            padding: 20px;
            background: var(--card-bg);
            border-radius: 20px;
            border: 1px solid var(--card-border);
            backdrop-filter: blur(12px);
            box-shadow: var(--shadow-lg);
            position: relative;
            overflow: hidden;
        }
        
        header::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: linear-gradient(90deg, var(--gradient-start), var(--gradient-end));
        }
        
        .logo {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            margin-bottom: 15px;
        }
        
        .logo-icon {
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, var(--gradient-start), var(--gradient-end));
            border-radius: 18px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 15px rgba(58, 134, 255, 0.3);
            position: relative;
            overflow: hidden;
        }
        
        .logo-icon::after {
            content: "";
            position: absolute;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transform: translateX(-100%);
            animation: logo-shine 3s infinite;
        }
        
        @keyframes logo-shine {
            0% { transform: translateX(-100%); }
            50%, 100% { transform: translateX(100%); }
        }
        
        .logo-icon i {
            font-size: 28px;
            color: white;
            z-index: 1;
        }
        
        h1 {
            font-size: 2.2rem;
            background: linear-gradient(to right, var(--gradient-start), var(--gradient-end));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            margin-bottom: 8px;
            font-weight: 800;
            letter-spacing: -0.5px;
        }
        
        .subtitle {
            color: var(--text-muted);
            font-size: 1.1rem;
            margin: 0 auto;
            max-width: 600px;
            line-height: 1.5;
        }
        
        .header-controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 20px;
            flex-wrap: wrap;
        }
        
        /* Theme Toggle */
        .theme-toggle {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 100;
        }
        
        .toggle-btn {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: var(--card-bg);
            border: 1px solid var(--card-border);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: var(--shadow);
            transition: all 0.3s ease;
        }
        
        .toggle-btn:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-lg);
        }
        
        .toggle-btn i {
            font-size: 1.2rem;
            color: var(--text-primary);
        }
        
        /* Dashboard Layout */
        .dashboard {
            display: grid;
            grid-template-columns: 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .card {
            background: var(--card-bg);
            border-radius: 20px;
            padding: 25px 20px;
            border: 1px solid var(--card-border);
            backdrop-filter: blur(10px);
            box-shadow: var(--shadow);
            position: relative;
            overflow: hidden;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        
        .card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-lg);
            background: var(--card-hover);
        }
        
        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--card-border);
        }
        
        .card-title {
            font-size: 1.5rem;
            display: flex;
            align-items: center;
            gap: 10px;
            font-weight: 600;
            color: var(--text-primary);
        }
        
        .card-title i {
            color: var(--primary);
            background: rgba(58, 134, 255, 0.15);
            width: 40px;
            height: 40px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        /* Controls */
        .controls {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .control-row {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }
        
        .control-group {
            display: flex;
            flex-direction: column;
            flex: 1;
            min-width: 180px;
        }
        
        label {
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--text-secondary);
            font-size: 0.95rem;
            display: flex;
            align-items: center;
            gap: 6px;
        }
        
        .info-icon {
            color: var(--primary-light);
            cursor: help;
            position: relative;
        }
        
        select, input {
            padding: 12px 15px;
            border-radius: 12px;
            border: 1px solid var(--card-border);
            background: var(--bg-secondary);
            color: var(--text-primary);
            font-size: 1rem;
            width: 100%;
            transition: all 0.3s ease;
        }
        
        select:focus, input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(58, 134, 255, 0.3);
        }
        
        /* Buttons */
        .btn {
            padding: 12px 20px;
            border-radius: 12px;
            border: none;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1rem;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            width: 100%;
        }
        
        .btn-primary {
            background: linear-gradient(to right, var(--gradient-start), var(--gradient-end));
            color: white;
            box-shadow: 0 4px 15px rgba(58, 134, 255, 0.3);
        }
        
        .btn-primary:hover {
            background: linear-gradient(to right, var(--primary-dark), #6d28d9);
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(58, 134, 255, 0.4);
        }
        
        .btn-outline {
            background: transparent;
            border: 2px solid var(--primary);
            color: var(--primary);
        }
        
        .btn-outline:hover {
            background: rgba(58, 134, 255, 0.1);
            transform: translateY(-3px);
        }
        
        .btn-success {
            background: var(--success);
            color: white;
            box-shadow: 0 4px 15px rgba(16, 185, 129, 0.3);
        }
        
        .btn-success:hover {
            background: var(--success-dark);
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(16, 185, 129, 0.4);
        }
        
        .btn-warning {
            background: rgba(239, 68, 68, 0.1);
            border: 2px solid rgba(239, 68, 68, 0.3);
            color: #ef4444;
        }
        
        .btn-warning:hover {
            background: rgba(239, 68, 68, 0.2);
            transform: translateY(-3px);
        }
        
        .btn-group {
            display: flex;
            flex-direction: column;
            gap: 12px;
            margin-top: 15px;
        }
        
        /* Tables */
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            font-size: 0.95rem;
        }
        
        th {
            background: var(--bg-secondary);
            padding: 14px 12px;
            text-align: left;
            color: var(--text-muted);
            font-weight: 600;
            font-size: 0.9rem;
            position: sticky;
            top: 0;
        }
        
        td {
            padding: 14px 12px;
            border-bottom: 1px solid var(--card-border);
            font-size: 0.95rem;
        }
        
        tr:last-child td {
            border-bottom: none;
        }
        
        tr:hover {
            background: var(--bg-secondary);
        }
        
        .profit {
            color: var(--success);
            font-weight: 700;
        }
        
        .loss {
            color: var(--danger);
            font-weight: 700;
        }
        
        /* Opportunity Cards */
        .opportunity-card {
            background: var(--bg-secondary);
            border-radius: 16px;
            padding: 20px;
            margin-top: 20px;
            border: 1px solid rgba(58, 134, 255, 0.3);
            background: linear-gradient(to right, var(--bg-secondary), var(--card-bg));
            position: relative;
            overflow: hidden;
        }
        
        .opportunity-card::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 4px;
            height: 100%;
            background: linear-gradient(to bottom, var(--gradient-start), var(--gradient-end));
        }
        
        .opportunity-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .opportunity-badge {
            padding: 6px 14px;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 700;
        }
        
        .badge-success {
            background: rgba(16, 185, 129, 0.2);
            color: var(--success);
        }
        
        .badge-warning {
            background: rgba(245, 158, 11, 0.2);
            color: var(--warning);
        }
        
        .opportunity-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
        }
        
        .opportunity-item {
            display: flex;
            flex-direction: column;
        }
        
        .opportunity-label {
            color: var(--text-muted);
            font-size: 0.9rem;
            margin-bottom: 5px;
        }
        
        .opportunity-value {
            font-size: 1.1rem;
            font-weight: 700;
        }
        
        /* Charts */
        .chart-container {
            height: 280px;
            margin-top: 20px;
            position: relative;
        }
        
        /* Notifications */
        .notification {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: var(--success);
            color: white;
            padding: 15px 20px;
            border-radius: 12px;
            box-shadow: var(--shadow-lg);
            display: flex;
            align-items: center;
            gap: 10px;
            z-index: 1000;
            transform: translateX(150%);
            transition: transform 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            max-width: 350px;
        }
        
        .notification.show {
            transform: translateX(0);
        }
        
        .notification.warning {
            background: var(--warning);
        }
        
        /* Status Indicators */
        .status-indicator {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.95rem;
            margin-top: 15px;
            color: var(--text-muted);
            padding: 10px 15px;
            background: var(--bg-secondary);
            border-radius: 12px;
        }
        
        .status-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background-color: var(--success);
        }
        
        .status-dot.offline {
            background-color: var(--danger);
        }
        
        .refresh-indicator {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.95rem;
        }
        
        /* Tooltips */
        .tooltip {
            position: absolute;
            background: var(--card-bg);
            border: 1px solid var(--primary);
            border-radius: 8px;
            padding: 12px;
            z-index: 100;
            max-width: 280px;
            font-size: 0.9rem;
            box-shadow: var(--shadow-lg);
            display: none;
            backdrop-filter: blur(10px);
            color: var(--text-primary);
        }
        
        /* Scan Status */
        .scan-status {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px 15px;
            background: var(--bg-secondary);
            border-radius: 12px;
            margin-top: 15px;
            font-size: 0.95rem;
        }
        
        .scan-status .spinner {
            width: 20px;
            height: 20px;
            border: 3px solid rgba(58, 134, 255, 0.3);
            border-top: 3px solid var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* Tabs */
        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            overflow-x: auto;
            padding-bottom: 5px;
        }
        
        .tab {
            padding: 12px 20px;
            background: var(--bg-secondary);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            white-space: nowrap;
            border: 1px solid transparent;
        }
        
        .tab.active {
            background: rgba(58, 134, 255, 0.2);
            border-color: var(--primary);
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        /* Arbitrage Path */
        .arbitrage-path {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            margin: 15px 0;
            flex-wrap: wrap;
        }
        
        .path-step {
            display: flex;
            align-items: center;
            gap: 5px;
            padding: 8px 12px;
            background: var(--bg-secondary);
            border-radius: 8px;
        }
        
        .path-arrow {
            color: var(--primary);
        }
        
        /* AI Prediction */
        .ai-prediction {
            background: linear-gradient(135deg, rgba(58, 134, 255, 0.1), rgba(131, 56, 236, 0.1));
            border: 1px solid rgba(58, 134, 255, 0.3);
            border-radius: 12px;
            padding: 15px;
            margin-top: 15px;
        }
        
        .ai-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 10px;
        }
        
        .ai-icon {
            color: var(--primary);
        }
        
        /* Portfolio Grid */
        .portfolio-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        
        .portfolio-card {
            background: var(--bg-secondary);
            border-radius: 12px;
            padding: 15px;
            border: 1px solid var(--card-border);
            transition: all 0.3s ease;
        }
        
        .portfolio-card:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow);
        }
        
        .portfolio-value {
            font-size: 1.5rem;
            font-weight: 700;
            margin: 10px 0;
        }
        
        .portfolio-change {
            font-size: 0.9rem;
        }
        
        /* Footer */
        footer {
            text-align: center;
            margin-top: 30px;
            padding: 20px;
            color: var(--text-muted);
            font-size: 0.9rem;
            background: var(--card-bg);
            border-radius: 16px;
            border: 1px solid var(--card-border);
        }
        
        /* Features Section */
        .features {
            display: grid;
            grid-template-columns: 1fr;
            gap: 20px;
            margin-top: 30px;
        }
        
        .feature {
            background: var(--bg-secondary);
            padding: 25px 20px;
            border-radius: 16px;
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            border: 1px solid var(--card-border);
            transition: transform 0.3s ease;
        }
        
        .feature:hover {
            transform: translateY(-5px);
            background: var(--card-bg);
        }
        
        .feature i {
            font-size: 2rem;
            color: var(--primary);
            margin-bottom: 15px;
            background: rgba(58, 134, 255, 0.15);
            width: 60px;
            height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 16px;
        }
        
        .feature h3 {
            margin-bottom: 12px;
            color: var(--text-primary);
            font-size: 1.2rem;
            font-weight: 600;
        }
        
        .feature p {
            color: var(--text-muted);
            font-size: 0.95rem;
            line-height: 1.6;
        }
        
        /* Disclaimer */
        .disclaimer {
            background: rgba(239, 68, 68, 0.1);
            border: 1px solid rgba(239, 68, 68, 0.3);
            border-radius: 16px;
            padding: 20px;
            margin-top: 30px;
            font-size: 0.9rem;
        }
        
        .disclaimer h3 {
            color: var(--danger);
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            font-size: 1.1rem;
            font-weight: 600;
        }
        
        /* Mobile-first responsive design */
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            
            h1 {
                font-size: 1.8rem;
            }
            
            .subtitle {
                font-size: 1rem;
            }
            
            .logo {
                flex-direction: column;
                gap: 10px;
            }
            
            .header-controls {
                flex-direction: column;
                align-items: center;
            }
            
            .control-row {
                flex-direction: column;
            }
            
            .control-group {
                min-width: 100%;
            }
            
            .btn {
                width: 100%;
            }
            
            .btn-group {
                flex-direction: column;
            }
            
            .opportunity-content {
                grid-template-columns: 1fr 1fr;
            }
            
            .portfolio-grid {
                grid-template-columns: 1fr 1fr;
            }
            
            .features {
                grid-template-columns: 1fr;
            }
            
            table {
                font-size: 0.85rem;
            }
            
            th, td {
                padding: 10px 8px;
            }
            
            .theme-toggle {
                top: 10px;
                right: 10px;
            }
            
            .toggle-btn {
                width: 40px;
                height: 40px;
            }
        }
        
        /* Tablet and larger */
        @media (min-width: 768px) {
            .dashboard {
                grid-template-columns: 1fr 1fr;
            }
            
            .btn-group {
                flex-direction: row;
                flex-wrap: wrap;
            }
            
            .btn {
                width: auto;
                flex: 1;
            }
            
            .features {
                grid-template-columns: repeat(2, 1fr);
            }
        }
        
        /* Desktop */
        @media (min-width: 1024px) {
            .features {
                grid-template-columns: repeat(4, 1fr);
            }
            
            .notification {
                max-width: 400px;
            }
        }
    </style>
</head>
<body class="light-mode">
    <div class="theme-toggle">
        <div class="toggle-btn" id="theme-toggle">
            <i class="fas fa-moon"></i>
        </div>
    </div>
    
    <div class="app-container">
        <header>
            <div class="logo">
                <div class="logo-icon">
                    <i class="fas fa-project-diagram"></i>
                </div>
                <div>
                    <h1>ArbMatrix Pro</h1>
                    <p class="subtitle">Advanced multi-leg crypto arbitrage with AI prediction & cross-chain opportunities</p>
                </div>
            </div>
            
            <div class="header-controls">
                <div class="refresh-indicator">
                    <i class="fas fa-sync-alt"></i>
                    <span>Auto-refresh: <span id="refresh-timer">30</span>s</span>
                </div>
                <button id="reset-btn" class="btn btn-warning">
                    <i class="fas fa-redo"></i> Reset App
                </button>
            </div>
        </header>
        
        <div class="tabs">
            <div class="tab active" data-tab="scanner">Arbitrage Scanner</div>
            <div class="tab" data-tab="triangular">Triangular Arbitrage</div>
            <div class="tab" data-tab="cross-chain">Cross-Chain</div>
            <div class="tab" data-tab="portfolio">Portfolio</div>
        </div>
        
        <div class="dashboard">
            <!-- Arbitrage Scanner Tab -->
            <div class="tab-content active" id="scanner-tab">
                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title"><i class="fas fa-search-dollar"></i> Advanced Arbitrage Scanner</h2>
                        <div class="scan-status" id="scan-status">
                            <div class="spinner"></div>
                            <span id="scan-text">Ready to scan</span>
                        </div>
                    </div>
                    
                    <div class="controls">
                        <div class="control-row">
                            <div class="control-group">
                                <label for="crypto-pair">
                                    Crypto Pair
                                    <i class="fas fa-info-circle info-icon" data-tooltip="Select cryptocurrency trading pair"></i>
                                </label>
                                <select id="crypto-pair">
                                    <option value="BTC/USDT">BTC/USDT</option>
                                    <option value="ETH/USDT" selected>ETH/USDT</option>
                                    <option value="SOL/USD">SOL/USD</option>
                                    <option value="BNB/USDT">BNB/USDT</option>
                                    <option value="XRP/USDT">XRP/USDT</option>
                                    <option value="ADA/USD">ADA/USD</option>
                                    <option value="DOGE/USD">DOGE/USD</option>
                                    <option value="DOT/USDT">DOT/USDT</option>
                                    <option value="LTC/USD">LTC/USD</option>
                                </select>
                            </div>
                            
                            <div class="control-group">
                                <label for="min-profit">
                                    Min Profit (%)
                                    <i class="fas fa-info-circle info-icon" data-tooltip="Minimum profit percentage to show opportunities"></i>
                                </label>
                                <input type="number" id="min-profit" value="0.5" step="0.1" min="0">
                            </div>
                        </div>
                        
                        <div class="control-row">
                            <div class="control-group">
                                <label for="fee-percentage">
                                    Trading Fee (%)
                                    <i class="fas fa-info-circle info-icon" data-tooltip="Your trading fee percentage on exchanges"></i>
                                </label>
                                <input type="number" id="fee-percentage" value="0.1" step="0.01" min="0">
                            </div>
                            
                            <div class="control-group">
                                <label for="transfer-fee">
                                    Transfer Fee (%)
                                    <i class="fas fa-info-circle info-icon" data-tooltip="Estimated network transfer fee"></i>
                                </label>
                                <input type="number" id="transfer-fee" value="0.05" step="0.01" min="0">
                            </div>
                        </div>
                    </div>
                    
                    <div class="btn-group">
                        <button id="scan-btn" class="btn btn-primary">
                            <i class="fas fa-sync-alt"></i> Scan Arbitrage
                        </button>
                        
                        <button id="export-csv" class="btn btn-outline">
                            <i class="fas fa-file-csv"></i> Export CSV
                        </button>
                        
                        <button id="auto-scan" class="btn btn-success">
                            <i class="fas fa-play"></i> Auto Scan
                        </button>
                    </div>
                    
                    <div class="status-indicator">
                        <div class="status-dot" id="status-dot"></div>
                        <span id="status-text">Connected to live market data</span>
                    </div>
                    
                    <div class="ai-prediction">
                        <div class="ai-header">
                            <i class="fas fa-robot ai-icon"></i>
                            <h3>AI Opportunity Prediction</h3>
                        </div>
                        <p>Based on market patterns, we predict a <strong>2.3% arbitrage opportunity</strong> for ETH/USDT in the next 15 minutes with 87% confidence.</p>
                    </div>
                    
                    <div style="overflow-x: auto;">
                        <table>
                            <thead>
                                <tr>
                                    <th>Exchange</th>
                                    <th>Price</th>
                                    <th>Spread</th>
                                    <th>Profit</th>
                                    <th>Volume (24h)</th>
                                    <th>Risk Score</th>
                                    <th>Action</th>
                                </tr>
                            </thead>
                            <tbody id="exchange-data">
                                <tr>
                                    <td colspan="7" style="text-align: center; padding: 30px;">
                                        <i class="fas fa-search" style="font-size: 2rem; margin-bottom: 15px; color: var(--text-muted);"></i>
                                        <p>Click "Scan Arbitrage" to find opportunities</p>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    
                    <div class="opportunity-card">
                        <div class="opportunity-header">
                            <h3>Best Opportunity</h3>
                            <span class="opportunity-badge badge-success">LIVE</span>
                        </div>
                        <div class="opportunity-content">
                            <div class="opportunity-item">
                                <span class="opportunity-label">Buy From</span>
                                <span class="opportunity-value" id="buy-exchange">-</span>
                            </div>
                            <div class="opportunity-item">
                                <span class="opportunity-label">Sell To</span>
                                <span class="opportunity-value" id="sell-exchange">-</span>
                            </div>
                            <div class="opportunity-item">
                                <span class="opportunity-label">Spread</span>
                                <span class="opportunity-value" id="spread-value">0.00%</span>
                            </div>
                            <div class="opportunity-item">
                                <span class="opportunity-label">Profit</span>
                                <span class="opportunity-value profit" id="profit-value">0.00%</span>
                            </div>
                            <div class="opportunity-item">
                                <span class="opportunity-label">Time Window</span>
                                <span class="opportunity-value" id="time-window">2-4 min</span>
                            </div>
                            <div class="opportunity-item">
                                <span class="opportunity-label">Success Probability</span>
                                <span class="opportunity-value" id="arb-success">87%</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title"><i class="fas fa-chart-line"></i> Risk Simulator</h2>
                    </div>
                    
                    <div class="controls">
                        <div class="control-row">
                            <div class="control-group">
                                <label for="simulation-type">Simulation Type</label>
                                <select id="simulation-type">
                                    <option value="monte-carlo">Monte Carlo</option>
                                    <option value="volatility">Volatility Analysis</option>
                                    <option value="historical">Historical Performance</option>
                                </select>
                            </div>
                            
                            <div class="control-group">
                                <label for="risk-factor">Risk Factor</label>
                                <select id="risk-factor">
                                    <option value="low">Low</option>
                                    <option value="medium" selected>Medium</option>
                                    <option value="high">High</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="control-row">
                            <div class="control-group">
                                <label for="simulation-period">Period (mins)</label>
                                <input type="number" id="simulation-period" value="10" min="1" max="60">
                            </div>
                            
                            <div class="control-group">
                                <label for="trade-amount">Trade Amount ($)</label>
                                <input type="number" id="trade-amount" value="1000" min="10">
                            </div>
                        </div>
                    </div>
                    
                    <div class="btn-group">
                        <button id="run-simulation" class="btn btn-primary">
                            <i class="fas fa-play"></i> Run Simulation
                        </button>
                        
                        <button id="save-simulation" class="btn btn-outline">
                            <i class="fas fa-save"></i> Save Profile
                        </button>
                    </div>
                    
                    <div class="chart-container">
                        <canvas id="risk-chart"></canvas>
                    </div>
                    
                    <div class="opportunity-card">
                        <div class="opportunity-header">
                            <h3>Risk Analysis</h3>
                            <span class="opportunity-badge badge-warning" id="risk-badge">MODERATE</span>
                        </div>
                        <div class="opportunity-content">
                            <div class="opportunity-item">
                                <span class="opportunity-label">Success Probability</span>
                                <span class="opportunity-value" id="success-prob">74%</span>
                            </div>
                            <div class="opportunity-item">
                                <span class="opportunity-label">Avg. Profit</span>
                                <span class="opportunity-value profit" id="avg-profit">0.42%</span>
                            </div>
                            <div class="opportunity-item">
                                <span class="opportunity-label">Max Drawdown</span>
                                <span class="opportunity-value loss" id="max-drawdown">-0.38%</span>
                            </div>
                            <div class="opportunity-item">
                                <span class="opportunity-label">Est. Profit</span>
                                <span class="opportunity-value profit" id="est-profit">$4.20</span>
                            </div>
                            <div class="opportunity-item">
                                <span class="opportunity-label">Volatility</span>
                                <span class="opportunity-value" id="volatility">1.25%</span>
                            </div>
                            <div class="opportunity-item">
                                <span class="opportunity-label">Risk Score</span>
                                <span class="opportunity-value" id="risk-score">5.8/10</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Triangular Arbitrage Tab -->
            <div class="tab-content" id="triangular-tab">
                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title"><i class="fas fa-exchange-alt"></i> Triangular Arbitrage</h2>
                    </div>
                    
                    <div class="controls">
                        <div class="control-row">
                            <div class="control-group">
                                <label for="tri-pair1">Trading Pair 1</label>
                                <select id="tri-pair1">
                                    <option value="BTC/USDT">BTC/USDT</option>
                                    <option value="ETH/USDT" selected>ETH/USDT</option>
                                    <option value="BNB/USDT">BNB/USDT</option>
                                </select>
                            </div>
                            
                            <div class="control-group">
                                <label for="tri-pair2">Trading Pair 2</label>
                                <select id="tri-pair2">
                                    <option value="ETH/BTC">ETH/BTC</option>
                                    <option value="BNB/BTC" selected>BNB/BTC</option>
                                    <option value="ADA/BTC">ADA/BTC</option>
                                </select>
                            </div>
                            
                            <div class="control-group">
                                <label for="tri-pair3">Trading Pair 3</label>
                                <select id="tri-pair3">
                                    <option value="BNB/ETH">BNB/ETH</option>
                                    <option value="ADA/ETH" selected>ADA/ETH</option>
                                    <option value="DOT/ETH">DOT/ETH</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    
                    <div class="btn-group">
                        <button id="scan-triangular" class="btn btn-primary">
                            <i class="fas fa-sync-alt"></i> Scan Triangular
                        </button>
                    </div>
                    
                    <div class="arbitrage-path" id="arbitrage-path">
                        <div class="path-step">
                            <span>ETH</span>
                            <i class="fas fa-arrow-right path-arrow"></i>
                            <span>BTC</span>
                        </div>
                        <div class="path-step">
                            <span>BTC</span>
                            <i class="fas fa-arrow-right path-arrow"></i>
                            <span>BNB</span>
                        </div>
                        <div class="path-step">
                            <span>BNB</span>
                            <i class="fas fa-arrow-right path-arrow"></i>
                            <span>ETH</span>
                        </div>
                    </div>
                    
                    <div class="opportunity-card">
                        <div class="opportunity-header">
                            <h3>Triangular Opportunity</h3>
                            <span class="opportunity-badge badge-success">PROFITABLE</span>
                        </div>
                        <div class="opportunity-content">
                            <div class="opportunity-item">
                                <span class="opportunity-label">Path</span>
                                <span class="opportunity-value">ETH → BTC → BNB → ETH</span>
                            </div>
                            <div class="opportunity-item">
                                <span class="opportunity-label">Profit</span>
                                <span class="opportunity-value profit">1.73%</span>
                            </div>
                            <div class="opportunity-item">
                                <span class="opportunity-label">Time Window</span>
                                <span class="opportunity-value">3-5 min</span>
                            </div>
                            <div class="opportunity-item">
                                <span class="opportunity-label">Complexity</span>
                                <span class="opportunity-value">Medium</span>
                            </div>
                            <div class="opportunity-item">
                                <span class="opportunity-label">Exchanges</span>
                                <span class="opportunity-value">Binance, KuCoin</span>
                            </div>
                            <div class="opportunity-item">
                                <span class="opportunity-label">Success Rate</span>
                                <span class="opportunity-value">78%</span>
                            </div>
                        </div>
                    </div>
                    
                    <div style="overflow-x: auto; margin-top: 20px;">
                        <table>
                            <thead>
                                <tr>
                                    <th>Arbitrage Path</th>
                                    <th>Profit</th>
                                    <th>Exchanges</th>
                                    <th>Time Window</th>
                                    <th>Risk</th>
                                    <th>Action</th>
                                </tr>
                            </thead>
                            <tbody id="triangular-data">
                                <tr>
                                    <td>ETH → BTC → BNB → ETH</td>
                                    <td class="profit">1.73%</td>
                                    <td>Binance, KuCoin</td>
                                    <td>3-5 min</td>
                                    <td>Medium</td>
                                    <td>
                                        <button class="btn btn-outline" style="padding: 5px 10px; font-size: 0.8rem;">
                                            <i class="fas fa-play"></i> Execute
                                        </button>
                                    </td>
                                </tr>
                                <tr>
                                    <td>BTC → ETH → ADA → BTC</td>
                                    <td class="profit">0.92%</td>
                                    <td>Binance, Coinbase</td>
                                    <td>2-4 min</td>
                                    <td>Low</td>
                                    <td>
                                        <button class="btn btn-outline" style="padding: 5px 10px; font-size: 0.8rem;">
                                            <i class="fas fa-play"></i> Execute
                                        </button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            
            <!-- Cross-Chain Tab -->
            <div class="tab-content" id="cross-chain-tab">
                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title"><i class="fas fa-link"></i> Cross-Chain Arbitrage</h2>
                    </div>
                    
                    <div class="controls">
                        <div class="control-row">
                            <div class="control-group">
                                <label for="source-chain">Source Chain</label>
                                <select id="source-chain">
                                    <option value="ethereum">Ethereum</option>
                                    <option value="bsc" selected>Binance Smart Chain</option>
                                    <option value="polygon">Polygon</option>
                                    <option value="avalanche">Avalanche</option>
                                    <option value="solana">Solana</option>
                                </select>
                            </div>
                            
                            <div class="control-group">
                                <label for="target-chain">Target Chain</label>
                                <select id="target-chain">
                                    <option value="ethereum">Ethereum</option>
                                    <option value="bsc">Binance Smart Chain</option>
                                    <option value="polygon" selected>Polygon</option>
                                    <option value="avalanche">Avalanche</option>
                                    <option value="solana">Solana</option>
                                </select>
                            </div>
                            
                            <div class="control-group">
                                <label for="bridge-protocol">Bridge Protocol</label>
                                <select id="bridge-protocol">
                                    <option value="any">Any</option>
                                    <option value="multichain" selected>Multichain</option>
                                    <option value="wormhole">Wormhole</option>
                                    <option value="axelar">Axelar</option>
                                    <option value="layerzero">LayerZero</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    
                    <div class="btn-group">
                        <button id="scan-cross-chain" class="btn btn-primary">
                            <i class="fas fa-sync-alt"></i> Scan Cross-Chain
                        </button>
                    </div>
                    
                    <div class="opportunity-card">
                        <div class="opportunity-header">
                            <h3>Cross-Chain Opportunity</h3>
                            <span class="opportunity-badge badge-success">HIGH PROFIT</span>
                        </div>
                        <div class="opportunity-content">
                            <div class="opportunity-item">
                                <span class="opportunity-label">Asset</span>
                                <span class="opportunity-value">USDC</span>
                            </div>
                            <div class="opportunity-item">
                                <span class="opportunity-label">Source Chain</span>
                                <span class="opportunity-value">BSC</span>
                            </div>
                            <div class="opportunity-item">
                                <span class="opportunity-label">Target Chain</span>
                                <span class="opportunity-value">Polygon</span>
                            </div>
                            <div class="opportunity-item">
                                <span class="opportunity-label">Price Difference</span>
                                <span class="opportunity-value profit">2.15%</span>
                            </div>
                            <div class="opportunity-item">
                                <span class="opportunity-label">Bridge Fee</span>
                                <span class="opportunity-value">0.12%</span>
                            </div>
                            <div class="opportunity-item">
                                <span class="opportunity-label">Net Profit</span>
                                <span class="opportunity-value profit">2.03%</span>
                            </div>
                        </div>
                    </div>
                    
                    <div style="overflow-x: auto; margin-top: 20px;">
                        <table>
                            <thead>
                                <tr>
                                    <th>Asset</th>
                                    <th>Source Chain</th>
                                    <th>Target Chain</th>
                                    <th>Price Diff</th>
                                    <th>Bridge</th>
                                    <th>Net Profit</th>
                                    <th>Action</th>
                                </tr>
                            </thead>
                            <tbody id="cross-chain-data">
                                <tr>
                                    <td>USDC</td>
                                    <td>BSC</td>
                                    <td>Polygon</td>
                                    <td class="profit">2.15%</td>
                                    <td>Multichain</td>
                                    <td class="profit">2.03%</td>
                                    <td>
                                        <button class="btn btn-outline" style="padding: 5px 10px; font-size: 0.8rem;">
                                            <i class="fas fa-play"></i> Bridge
                                        </button>
                                    </td>
                                </tr>
                                <tr>
                                    <td>ETH</td>
                                    <td>Ethereum</td>
                                    <td>Avalanche</td>
                                    <td class="profit">1.42%</td>
                                    <td>Axelar</td>
                                    <td class="profit">1.28%</td>
                                    <td>
                                        <button class="btn btn-outline" style="padding: 5px 10px; font-size: 0.8rem;">
                                            <i class="fas fa-play"></i> Bridge
                                        </button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            
            <!-- Portfolio Tab -->
            <div class="tab-content" id="portfolio-tab">
                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title"><i class="fas fa-chart-pie"></i> Arbitrage Portfolio</h2>
                    </div>
                    
                    <div class="portfolio-grid">
                        <div class="portfolio-card">
                            <h3>Total Profit</h3>
                            <div class="portfolio-value profit">$1,842.50</div>
                            <div class="portfolio-change profit">+4.2% today</div>
                        </div>
                        
                        <div class="portfolio-card">
                            <h3>Active Trades</h3>
                            <div class="portfolio-value">12</div>
                            <div class="portfolio-change">3 pending execution</div>
                        </div>
                        
                        <div class="portfolio-card">
                            <h3>Success Rate</h3>
                            <div class="portfolio-value">87.3%</div>
                            <div class="portfolio-change">+2.1% this week</div>
                        </div>
                        
                        <div class="portfolio-card">
                            <h3>Risk Score</h3>
                            <div class="portfolio-value">6.2/10</div>
                            <div class="portfolio-change">Medium risk</div>
                        </div>
                    </div>
                    
                    <div class="chart-container">
                        <canvas id="portfolio-chart"></canvas>
                    </div>
                    
                    <div style="overflow-x: auto; margin-top: 20px;">
                        <table>
                            <thead>
                                <tr>
                                    <th>Date</th>
                                    <th>Asset</th>
                                    <th>Type</th>
                                    <th>Amount</th>
                                    <th>Profit/Loss</th>
                                    <th>Status</th>
                                </tr>
                            </thead>
                            <tbody id="portfolio-history">
                                <tr>
                                    <td>2023-06-15 14:32</td>
                                    <td>ETH/USDT</td>
                                    <td>Simple Arbitrage</td>
                                    <td>$1,000</td>
                                    <td class="profit">+$12.50</td>
                                    <td><span class="badge-success">Completed</span></td>
                                </tr>
                                <tr>
                                    <td>2023-06-15 13:45</td>
                                    <td>BTC/ETH/BNB</td>
                                    <td>Triangular</td>
                                    <td>$2,500</td>
                                    <td class="profit">+$31.75</td>
                                    <td><span class="badge-success">Completed</span></td>
                                </tr>
                                <tr>
                                    <td>2023-06-15 12:20</td>
                                    <td>USDC (BSC→Polygon)</td>
                                    <td>Cross-Chain</td>
                                    <td>$5,000</td>
                                    <td class="profit">+$101.50</td>
                                    <td><span class="badge-success">Completed</span></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="features">
            <div class="feature">
                <i class="fas fa-project-diagram"></i>
                <h3>Multi-Leg Arbitrage</h3>
                <p>Detect complex triangular and multi-exchange arbitrage paths automatically.</p>
            </div>
            <div class="feature">
                <i class="fas fa-link"></i>
                <h3>Cross-Chain</h3>
                <p>Find arbitrage opportunities across different blockchain networks and bridges.</p>
            </div>
            <div class="feature">
                <i class="fas fa-robot"></i>
                <h3>AI Prediction</h3>
                <p>Machine learning algorithms predict future arbitrage opportunities with high accuracy.</p>
            </div>
            <div class="feature">
                <i class="fas fa-shield-alt"></i>
                <h3>Risk Management</h3>
                <p>Advanced risk scoring and portfolio management for sustainable arbitrage trading.</p>
            </div>
        </div>
        
        <div class="disclaimer">
            <h3><i class="fas fa-exclamation-triangle"></i> Important Disclaimer</h3>
            <p>Crypto arbitrage involves significant risks including price volatility, execution risk, and technical failures. This tool is for informational purposes only and does not constitute financial advice. Always do your own research, understand the risks, and never invest more than you can afford to lose.</p>
        </div>
        
        <div id="notification" class="notification">
            <i class="fas fa-bell"></i>
            <span id="notification-text">New arbitrage opportunity found!</span>
        </div>
        
        <div class="tooltip" id="tooltip"></div>
        
        <footer>
            <p>ArbMatrix Pro - Advanced Crypto Arbitrage Platform | Multi-Leg & Cross-Chain Detection</p>
            <p>© 2023 ArbMatrix Technologies | All computations happen locally | Privacy Guaranteed</p>
        </footer>
    </div>

    <script>
        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            initThemeToggle();
            initRiskChart();
            initPortfolioChart();
            setupEventListeners();
            initTooltips();
            initTabs();
            
            // Request notification permission
            if (Notification.permission !== 'granted') {
                Notification.requestPermission();
            }
            
            // Load initial data
            fetchMarketData();
            
            // Start refresh timer
            startRefreshTimer();
        });
        
        // Theme Toggle
        function initThemeToggle() {
            const themeToggle = document.getElementById('theme-toggle');
            const icon = themeToggle.querySelector('i');
            
            // Check for saved theme preference or default to light
            const currentTheme = localStorage.getItem('theme') || 'light-mode';
            document.body.className = currentTheme;
            
            // Update icon based on current theme
            if (currentTheme === 'dark-mode') {
                icon.className = 'fas fa-sun';
            } else {
                icon.className = 'fas fa-moon';
            }
            
            themeToggle.addEventListener('click', function() {
                if (document.body.classList.contains('light-mode')) {
                    document.body.classList.replace('light-mode', 'dark-mode');
                    localStorage.setItem('theme', 'dark-mode');
                    icon.className = 'fas fa-sun';
                } else {
                    document.body.classList.replace('dark-mode', 'light-mode');
                    localStorage.setItem('theme', 'light-mode');
                    icon.className = 'fas fa-moon';
                }
            });
        }
        
        // Tabs functionality
        function initTabs() {
            const tabs = document.querySelectorAll('.tab');
            const tabContents = document.querySelectorAll('.tab-content');
            
            tabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    // Remove active class from all tabs and contents
                    tabs.forEach(t => t.classList.remove('active'));
                    tabContents.forEach(c => c.classList.remove('active'));
                    
                    // Add active class to clicked tab
                    tab.classList.add('active');
                    
                    // Show corresponding content
                    const tabId = tab.getAttribute('data-tab');
                    document.getElementById(`${tabId}-tab`).classList.add('active');
                });
            });
        }
        
        // Tooltips
        function initTooltips() {
            const infoIcons = document.querySelectorAll('.info-icon');
            const tooltip = document.getElementById('tooltip');
            
            infoIcons.forEach(icon => {
                icon.addEventListener('mouseover', function(e) {
                    const rect = e.target.getBoundingClientRect();
                    tooltip.style.display = 'block';
                    tooltip.style.top = (rect.bottom + window.scrollY) + 'px';
                    tooltip.style.left = rect.left + 'px';
                    tooltip.textContent = e.target.dataset.tooltip;
                });
                
                icon.addEventListener('mouseout', function() {
                    tooltip.style.display = 'none';
                });
            });
        }
        
        // Chart instances
        let riskChart = null;
        let portfolioChart = null;
        let autoScanInterval = null;
        let refreshTimer = 30;
        let refreshInterval = null;
        
        // Initialize Risk Chart
        function initRiskChart() {
            const ctx = document.getElementById('risk-chart').getContext('2d');
            
            riskChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: Array.from({length: 20}, (_, i) => i + 1),
                    datasets: [{
                        label: 'Profit Probability',
                        data: [65, 68, 70, 72, 75, 74, 73, 71, 69, 68, 67, 66, 65, 64, 63, 62, 61, 60, 59, 58],
                        borderColor: '#10b981',
                        backgroundColor: 'rgba(16, 185, 129, 0.1)',
                        borderWidth: 2,
                        fill: true,
                        tension: 0.4,
                        pointBackgroundColor: '#10b981',
                        pointBorderColor: '#ffffff',
                        pointBorderWidth: 2,
                        pointRadius: 4,
                        pointHoverRadius: 6
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            grid: {
                                color: 'rgba(148, 163, 184, 0.1)'
                            },
                            ticks: {
                                color: '#94a3b8',
                                callback: function(value) {
                                    return value + '%';
                                }
                            }
                        },
                        x: {
                            grid: {
                                display: false
                            },
                            ticks: {
                                color: '#94a3b8'
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            backgroundColor: 'rgba(30, 41, 59, 0.9)',
                            titleColor: '#f8fafc',
                            bodyColor: '#e2e8f0',
                            borderColor: 'rgba(148, 163, 184, 0.2)',
                            borderWidth: 1,
                            callbacks: {
                                label: function(context) {
                                    return `Profit chance: ${context.parsed.y.toFixed(1)}%`;
                                }
                            }
                        }
                    }
                }
            });
        }
        
        // Initialize Portfolio Chart
        function initPortfolioChart() {
            const ctx = document.getElementById('portfolio-chart').getContext('2d');
            
            portfolioChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: ['Jun 9', 'Jun 10', 'Jun 11', 'Jun 12', 'Jun 13', 'Jun 14', 'Jun 15'],
                    datasets: [{
                        label: 'Portfolio Value',
                        data: [1200, 1350, 1420, 1550, 1620, 1740, 1842],
                        borderColor: '#3a86ff',
                        backgroundColor: 'rgba(58, 134, 255, 0.1)',
                        borderWidth: 2,
                        fill: true,
                        tension: 0.4,
                        pointBackgroundColor: '#3a86ff',
                        pointBorderColor: '#ffffff',
                        pointBorderWidth: 2,
                        pointRadius: 4,
                        pointHoverRadius: 6
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            grid: {
                                color: 'rgba(148, 163, 184, 0.1)'
                            },
                            ticks: {
                                color: '#94a3b8',
                                callback: function(value) {
                                    return '$' + value;
                                }
                            }
                        },
                        x: {
                            grid: {
                                display: false
                            },
                            ticks: {
                                color: '#94a3b8'
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            backgroundColor: 'rgba(30, 41, 59, 0.9)',
                            titleColor: '#f8fafc',
                            bodyColor: '#e2e8f0',
                            borderColor: 'rgba(148, 163, 184, 0.2)',
                            borderWidth: 1,
                            callbacks: {
                                label: function(context) {
                                    return `Portfolio: $${context.parsed.y}`;
                                }
                            }
                        }
                    }
                }
            });
        }
        
        // Event Listeners
        function setupEventListeners() {
            document.getElementById('scan-btn').addEventListener('click', scanArbitrage);
            document.getElementById('export-csv').addEventListener('click', exportCSV);
            document.getElementById('run-simulation').addEventListener('click', runSimulation);
            document.getElementById('crypto-pair').addEventListener('change', resetOpportunityData);
            document.getElementById('auto-scan').addEventListener('click', toggleAutoScan);
            document.getElementById('trade-amount').addEventListener('change', updateRiskSimulation);
            document.getElementById('reset-btn').addEventListener('click', resetApplication);
            document.getElementById('scan-triangular').addEventListener('click', scanTriangularArbitrage);
            document.getElementById('scan-cross-chain').addEventListener('click', scanCrossChainArbitrage);
        }
        
        // Start Refresh Timer
        function startRefreshTimer() {
            clearInterval(refreshInterval);
            refreshInterval = setInterval(() => {
                refreshTimer--;
                document.getElementById('refresh-timer').textContent = refreshTimer;
                
                if (refreshTimer <= 0) {
                    refreshTimer = 30;
                    fetchMarketData();
                }
            }, 1000);
        }
        
        // Simulate fetching market data
        async function fetchMarketData() {
            const pair = document.getElementById('crypto-pair').value;
            
            // Show scanning status
            document.getElementById('scan-text').textContent = "Updating market data...";
            document.getElementById('scan-status').style.display = 'flex';
            
            try {
                // Simulate API call delay
                await new Promise(resolve => setTimeout(resolve, 1500));
                
                // Update status
                updateStatus(true);
                document.getElementById('scan-text').textContent = "Market data updated";
                
                setTimeout(() => {
                    document.getElementById('scan-status').style.display = 'none';
                }, 2000);
            } catch (error) {
                console.error('Error fetching market data:', error);
                updateStatus(false, 'Error fetching data. Retrying...');
                document.getElementById('scan-text').textContent = "Data update failed";
                
                setTimeout(() => {
                    document.getElementById('scan-status').style.display = 'none';
                }, 2000);
            }
        }
        
        // Update connection status
        function updateStatus(connected, message = '') {
            const statusDot = document.getElementById('status-dot');
            const statusText = document.getElementById('status-text');
            
            if (connected) {
                statusDot.className = 'status-dot';
                statusText.textContent = message || 'Connected to live market data';
                statusText.style.color = 'var(--text-muted)';
            } else {
                statusDot.className = 'status-dot offline';
                statusText.textContent = message || 'Offline. Using cached data.';
                statusText.style.color = 'var(--danger)';
            }
        }
        
        // Scan for arbitrage opportunities
        async function scanArbitrage() {
            const pair = document.getElementById('crypto-pair').value;
            const feePercentage = parseFloat(document.getElementById('fee-percentage').value) || 0.1;
            const transferFee = parseFloat(document.getElementById('transfer-fee').value) || 0.05;
            const minProfit = parseFloat(document.getElementById('min-profit').value) || 0.5;
            
            // Show scanning status
            document.getElementById('scan-text').textContent = "Scanning exchanges...";
            document.getElementById('scan-status').style.display = 'flex';
            
            await fetchMarketData();
            refreshTimer = 30; // Reset timer after manual scan
            
            // Simulate finding opportunities
            setTimeout(() => {
                // Update the table with simulated data
                renderExchangeTable(feePercentage, transferFee);
                
                // Update opportunity card
                document.getElementById('buy-exchange').textContent = `Binance: $${(1850 + Math.random() * 50).toFixed(2)}`;
                document.getElementById('sell-exchange').textContent = `Coinbase: $${(1920 + Math.random() * 50).toFixed(2)}`;
                
                const spread = 3.2 + Math.random();
                document.getElementById('spread-value').textContent = `${spread.toFixed(2)}%`;
                
                const profit = spread - (2 * feePercentage) - transferFee;
                document.getElementById('profit-value').textContent = `${profit.toFixed(2)}%`;
                
                // Calculate time window based on profit and volatility
                const timeWindow = profit > 1.5 ? "1-2 min" : profit > 0.8 ? "2-4 min" : "4-8 min";
                document.getElementById('time-window').textContent = timeWindow;
                
                // Calculate success probability
                const successProb = Math.min(95, Math.max(60, profit * 25));
                document.getElementById('arb-success').textContent = `${successProb.toFixed(0)}%`;
                
                // Show notification if significant opportunity
                if (profit > minProfit) {
                    showNotification(`Arbitrage opportunity: ${profit.toFixed(2)}% profit on ${pair}`);
                    
                    // Browser notification
                    if (Notification.permission === 'granted') {
                        new Notification('ArbMatrix Opportunity', {
                            body: `${profit.toFixed(2)}% profit on ${pair}`,
                            icon: 'data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0iIzNhODZmZiI+PHBhdGggZD0iTTEzLjc4OCw1LjQ4NEMxNC40NDUsNC44MjcgMTUuNTU1LDQuODI3IDE2LjIxMiw1LjQ4NGw1LjMwNyw1LjMwN2MxLjMxLDEuMzEgMS4zMSwzLjQzNiAwLDQuNzQ2bC01LjMwNyw1LjMwN2MtMC42NTcsMC42NTctMS43NjcsMC42NTctMi40MjQsMEwxMy43ODgsMTUuNUg1Yy0xLjEwMywwLTItMC44OTctMi0ydi0zYzAtMS4xMDMsMC44OTctMiwyLTJoOC43ODhMMTMuNzg4LDUuNDg0eiIvPjwvc3ZnPg=='
                        });
                    }
                }
                
                // Update risk simulation based on this opportunity
                updateRiskSimulation(profit);
                
                // Update scan status
                document.getElementById('scan-text').textContent = "Scan completed!";
                setTimeout(() => {
                    document.getElementById('scan-status').style.display = 'none';
                }, 2000);
            }, 1000);
        }
        
        // Render exchange table with simulated data
        function renderExchangeTable(feePercentage, transferFee) {
            const tableBody = document.getElementById('exchange-data');
            tableBody.innerHTML = '';
            
            const exchanges = [
                { name: 'Binance', price: 1850 + Math.random() * 50, volume: 10000000 + Math.random() * 50000000 },
                { name: 'Coinbase', price: 1920 + Math.random() * 50, volume: 8000000 + Math.random() * 40000000 },
                { name: 'Kraken', price: 1880 + Math.random() * 50, volume: 6000000 + Math.random() * 30000000 },
                { name: 'KuCoin', price: 1860 + Math.random() * 50, volume: 5000000 + Math.random() * 25000000 }
            ];
            
            // Sort by price (lowest to highest)
            exchanges.sort((a, b) => a.price - b.price);
            const lowestPrice = exchanges[0].price;
            
            exchanges.forEach(exchange => {
                const row = document.createElement('tr');
                
                // Calculate spread relative to lowest price
                const spread = ((exchange.price - lowestPrice) / lowestPrice) * 100;
                
                // Calculate profit (spread - 2*fees - transfer cost)
                const profit = spread - (2 * feePercentage) - transferFee;
                
                // Determine profit/loss class
                const profitClass = profit > 0.5 ? 'profit' : (profit > 0 ? '' : 'loss');
                
                // Calculate risk score based on volume and profit consistency
                const riskScore = Math.min(10, Math.max(1, 10 - (profit * 2) + (exchange.volume / 10000000)));
                
                // Format volume
                const volume = exchange.volume > 1000000 
                    ? `$${(exchange.volume / 1000000).toFixed(2)}M` 
                    : `$${(exchange.volume / 1000).toFixed(1)}K`;
                
                row.innerHTML = `
                    <td>${exchange.name}</td>
                    <td>$${exchange.price.toFixed(2)}</td>
                    <td>${spread.toFixed(2)}%</td>
                    <td class="${profitClass}">${profit.toFixed(2)}%</td>
                    <td>${volume}</td>
                    <td>${riskScore.toFixed(1)}/10</td>
                    <td>
                        <button class="btn btn-outline" style="padding: 5px 10px; font-size: 0.8rem;">
                            <i class="fas fa-external-link-alt"></i> Trade
                        </button>
                    </td>
                `;
                
                tableBody.appendChild(row);
            });
        }
        
        // Update risk simulation
        function updateRiskSimulation(profit) {
            // Get additional parameters
            const tradeAmount = parseFloat(document.getElementById('trade-amount').value) || 1000;
            const riskFactor = document.getElementById('risk-factor').value;
            
            // Generate simulation data based on profit value and risk factor
            const data = [];
            let volatility;
            
            switch(riskFactor) {
                case 'low':
                    volatility = 0.05 + (Math.random() * 0.05);
                    break;
                case 'high':
                    volatility = 0.2 + (Math.random() * 0.3);
                    break;
                default:
                    volatility = 0.1 + (Math.random() * 0.15);
            }
            
            for (let i = 0; i < 20; i++) {
                // Simulate decreasing probability over time
                const probability = Math.max(0, profit * 15 - i * (volatility * 3));
                data.push(probability);
            }
            
            // Update chart
            riskChart.data.datasets[0].data = data;
            riskChart.update();
            
            // Calculate metrics
            const successProb = Math.min(95, Math.max(5, profit * 20));
            const avgProfit = Math.max(0.1, profit * 0.9);
            const maxDrawdown = Math.min(0, -(profit * 0.25));
            const estProfit = (tradeAmount * avgProfit / 100).toFixed(2);
            const vol = (volatility * 100).toFixed(2);
            const riskScore = (8 - volatility * 20).toFixed(1);
            
            // Update UI
            document.getElementById('success-prob').textContent = `${successProb.toFixed(0)}%`;
            document.getElementById('avg-profit').textContent = `${avgProfit.toFixed(2)}%`;
            document.getElementById('max-drawdown').textContent = `${maxDrawdown.toFixed(2)}%`;
            document.getElementById('volatility').textContent = `${vol}%`;
            document.getElementById('est-profit').textContent = `$${estProfit}`;
            document.getElementById('risk-score').textContent = `${riskScore}/10`;
            
            // Update risk badge
            const riskBadge = document.getElementById('risk-badge');
            if (successProb > 75) {
                riskBadge.className = 'opportunity-badge badge-success';
                riskBadge.textContent = 'LOW RISK';
            } else if (successProb > 50) {
                riskBadge.className = 'opportunity-badge badge-warning';
                riskBadge.textContent = 'MODERATE';
            } else {
                riskBadge.className = 'opportunity-badge';
                riskBadge.style.background = 'rgba(239, 68, 68, 0.2)';
                riskBadge.style.color = '#ef4444';
                riskBadge.textContent = 'HIGH RISK';
            }
        }
        
        // Run simulation
        function runSimulation() {
            const btn = document.getElementById('run-simulation');
            const originalText = btn.innerHTML;
            btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Simulating...';
            btn.disabled = true;
            
            setTimeout(() => {
                const profitValue = parseFloat(document.getElementById('profit-value').textContent) || 0.5;
                updateRiskSimulation(profitValue);
                
                btn.innerHTML = originalText;
                btn.disabled = false;
                
                showNotification("Risk simulation completed successfully");
            }, 1500);
        }
        
        // Show notification
        function showNotification(message, type = "success") {
            const notification = document.getElementById('notification');
            const notificationText = document.getElementById('notification-text');
            
            notificationText.textContent = message;
            notification.className = `notification show ${type}`;
            
            setTimeout(() => {
                notification.className = "notification";
            }, 5000);
        }
        
        // Export CSV
        function exportCSV() {
            const pair = document.getElementById('crypto-pair').value;
            const now = new Date();
            const timestamp = now.toISOString().replace(/[:.]/g, '-');
            const filename = `arbmatrix-${pair}-${timestamp}.csv`;
            
            // Create CSV content
            let csvContent = "Exchange,Price,Spread,Profit,Volume,Risk Score\n";
            const rows = document.querySelectorAll('#exchange-data tr');
            
            rows.forEach(row => {
                const cells = row.querySelectorAll('td');
                if (cells.length >= 6) {
                    const exchange = cells[0].textContent;
                    const price = cells[1].textContent.replace('$', '');
                    const spread = cells[2].textContent.replace('%', '');
                    const profit = cells[3].textContent.replace('%', '');
                    const volume = cells[4].textContent;
                    const riskScore = cells[5].textContent;
                    csvContent += `"${exchange}",${price},${spread},${profit},"${volume}","${riskScore}"\n`;
                }
            });
            
            // Create download link
            const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            const url = URL.createObjectURL(blob);
            link.setAttribute('href', url);
            link.setAttribute('download', filename);
            link.style.visibility = 'hidden';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            showNotification(`CSV exported: ${filename}`);
        }
        
        // Toggle auto scan
        function toggleAutoScan() {
            const autoScanBtn = document.getElementById('auto-scan');
            
            if (autoScanInterval) {
                clearInterval(autoScanInterval);
                autoScanInterval = null;
                autoScanBtn.innerHTML = '<i class="fas fa-play"></i> Auto Scan';
                autoScanBtn.classList.remove('btn-outline');
                autoScanBtn.classList.add('btn-success');
                showNotification("Auto scan disabled");
            } else {
                autoScanInterval = setInterval(() => {
                    scanArbitrage();
                }, 30000);
                autoScanBtn.innerHTML = '<i class="fas fa-stop"></i> Stop Scan';
                autoScanBtn.classList.remove('btn-success');
                autoScanBtn.classList.add('btn-outline');
                showNotification("Auto scan enabled - scanning every 30 seconds");
                scanArbitrage(); // Run immediately
            }
        }
        
        // Reset opportunity data
        function resetOpportunityData() {
            document.getElementById('buy-exchange').textContent = '-';
            document.getElementById('sell-exchange').textContent = '-';
            document.getElementById('spread-value').textContent = '0.00%';
            document.getElementById('profit-value').textContent = '0.00%';
            
            if (autoScanInterval) {
                clearInterval(autoScanInterval);
                autoScanInterval = null;
                document.getElementById('auto-scan').innerHTML = '<i class="fas fa-play"></i> Auto Scan';
                document.getElementById('auto-scan').classList.remove('btn-outline');
                document.getElementById('auto-scan').classList.add('btn-success');
            }
        }
        
        // Scan triangular arbitrage
        function scanTriangularArbitrage() {
            showNotification("Scanning for triangular arbitrage opportunities...");
            
            // Simulate API call delay
            setTimeout(() => {
                showNotification("Found 2 triangular arbitrage opportunities!");
            }, 1500);
        }
        
        // Scan cross-chain arbitrage
        function scanCrossChainArbitrage() {
            showNotification("Scanning for cross-chain arbitrage opportunities...");
            
            // Simulate API call delay
            setTimeout(() => {
                showNotification("Found 3 cross-chain arbitrage opportunities!");
            }, 1500);
        }
        
        // Reset application
        function resetApplication() {
            // Stop auto-scan if running
            if (autoScanInterval) {
                clearInterval(autoScanInterval);
                autoScanInterval = null;
                document.getElementById('auto-scan').innerHTML = '<i class="fas fa-play"></i> Auto Scan';
                document.getElementById('auto-scan').classList.remove('btn-outline');
                document.getElementById('auto-scan').classList.add('btn-success');
            }
            
            // Reset form inputs to initial values
            document.getElementById('crypto-pair').value = "ETH/USDT";
            document.getElementById('min-profit').value = 0.5;
            document.getElementById('fee-percentage').value = 0.1;
            document.getElementById('transfer-fee').value = 0.05;
            document.getElementById('simulation-type').value = "monte-carlo";
            document.getElementById('risk-factor').value = "medium";
            document.getElementById('simulation-period').value = 10;
            document.getElementById('trade-amount').value = 1000;
            
            // Reset table and opportunity data
            document.getElementById('exchange-data').innerHTML = `
                <tr>
                    <td colspan="7" style="text-align: center; padding: 30px;">
                        <i class="fas fa-search" style="font-size: 2rem; margin-bottom: 15px; color: var(--text-muted);"></i>
                        <p>Click "Scan Arbitrage" to find opportunities</p>
                    </td>
                </tr>
            `;
            
            resetOpportunityData();
            
            // Reset risk chart
            if (riskChart) {
                riskChart.destroy();
            }
            initRiskChart();
            
            // Reset status indicator
            updateStatus(true, 'Connected to live market data');
            
            // Reset refresh timer
            refreshTimer = 30;
            document.getElementById('refresh-timer').textContent = refreshTimer;
            
            // Hide scan status
            document.getElementById('scan-status').style.display = 'none';
            
            // Show reset notification
            showNotification("Application has been reset to initial state");
        }
    </script>
</body>
</html>